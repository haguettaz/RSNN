\documentclass{article}
\usepackage[a4paper, total={6in, 9in}]{geometry}
\usepackage[utf8]{inputenc}
\usepackage{research}
\usepackage[english]{babel}

\title{On counting firing signals}
\author{Hugo Aguettaz}
\begin{document}
    \maketitle
    % \section{Introduction}

    % The aim of this work is to count the number of binary sequences of length $n$, such that 
    % after one \emph{spike}, there is a resting period of size larger or equal to $T_r$. One could notice that in the trivial case
    % where $T_r = 0$, the number of such sequence is simply the number of binary sequences of size $n$, i.e. $2^n$.
    % Mathematically, we can formulate the set of all valid sequences as :
    % \begin{equation}
    %   \begin{split}
    %     \mathcal{Y}_{T_r}^n & = \{ (y_1, \dots, y_n) \in \{0, 1\}^n : \\
    %     & \sum_{k=0}^{T_r} y_{i+k\omod{n}{1}} \in \{0, 1\}, i \in \Nk{n}\},
    %   \end{split}
    % \end{equation}
    % where we used the modulo with offset defined by $m \omod{n}{d} = m \mod{n} + d$, for $m$, $n$ and $d \in \Integers$.
    % Let $\ell_{T_r}^n$ be the number of such sequences, i.e., $\ell_{T_r}^n = 
    % |\mathcal{Y}_{T_r}^n|$.
    
    % % ----------------------------------------------
    
    \section{Firing signals} \label{sec:aperiodic}

    We first consider firing signals of size $n \in \Integers_{\geq 0}$ with refractory period $T_r \in \Integers_{\geq 0}$. Those signals can be represented by binary 
    sequences of length $n$ such that there are at least $T_r$ zeros between two consecutive ones. Let $\tilde{\mathcal{Y}}_{T_r}^n$
    represent the set of such sequences. We formally define this set as
    
    \begin{equation}
        \tilde{\mathcal{Y}}_{T_r}^n = \left\{ (y_1, \dots, y_n) \in \{0, 1\}^n :
       \sum_{m=0}^{\min\{T_r, n - m\}} y_{k+m} \in \{0, 1\}, k \in \Nk{n} \right\}.
    \end{equation}
    
    Obviously, if $T_r = 0$, $\tilde{\mathcal{Y}}_{T_r}^n$ simplifies to 
    \begin{equation}
      \tilde{\mathcal{Y}}_{T_r}^n = \{0, 1\}^n,
    \end{equation}
    and this trivial case is irrelevant for our purpose. That is why, from now on, we will assume $T_r > 0$.
    
    % \begin{theorem}\label{thm:1-1}
    %   Let $\{y_1, \dots, y_n\}$ be a binary sequence of length $n$. If $\{y_1, \dots, y_n\} \in \tilde{\mathcal{Y}}_{0, T_r}^n$, 
    %   then $\{y_1, \dots, y_n, 0\} \in \tilde{\mathcal{Y}}_{T_r}^{n+1}$ and 
    %   $\{y_1, \dots, y_n, 1\} \in \tilde{\mathcal{Y}}_{T_r}^{n+1}$.
    % \end{theorem}
    
    % \begin{proof}
    %   Let $\{y_1, \dots, y_n\}$ be a binary sequence of length $n$ such that $\{y_1, \dots, y_n\} \in \tilde{\mathcal{Y}}_{0, T_r}^n$. 
    %   Clearly, adding a 0 at the end of an arbitrary aperiodic-valid sequence does not affect its validity. Thus 
    %   $\{y_1, \dots, y_n, 0\} \in \tilde{\mathcal{Y}}_{T_r}^{n+1}$. Moreover, if the sequence ends with $T_r$ 0s and is aperiodic-valid, 
    %   we can also add a 1 to this sequence as this 1 is preceeded by $T_r$ 0s. The new sequence is still aperiodic-valid and 
    %   $\{y_1, \dots, y_n, 1\} \in \tilde{\mathcal{Y}}_{T_r}^{n+1}$.
    % \end{proof}
    
    % \begin{theorem}\label{thm:1-2}
    %   Let $\{y_1, \dots, y_n\}$ be a binary sequence of length $n$. If $\{y_1, \dots, y_n\} \in \tilde{\mathcal{Y}}_{0^\mathsf{c}, T_r}^n$, 
    %   then $\{y_1, \dots, y_n, 0\} \in \tilde{\mathcal{Y}}_{T_r}^{n+1}$ but $\{y_1, \dots, y_n, 1\} \not \in \tilde{\mathcal{Y}}_{T_r}^{n+1}$.
    % \end{theorem}
    
    % \begin{proof}
    %   Let $\{y_1, \dots, y_n\}$ be a binary sequence of length $n$ such that $\{y_1, \dots, y_n\} \in \tilde{\mathcal{Y}}_{0^\mathsf{c}, T_r}^n$. 
    %   Clearly, adding a 0 at the end of an arbitrary valid sequence does not affect its validity. Thus 
    %   $\{y_1, \dots, y_n, 0\} \in \tilde{\mathcal{Y}}_{T_r}^{n+1}$. However, we cannot add a 1 at the end of this sequence as there are 
    %   not $T_r$ consecutive 0s before and thus the resulting sequeunce would be invalid. Thus 
    %   $\{y_1, \dots, y_n, 1\} \not \in \tilde{\mathcal{Y}}_{T_r}^{n+1}$.
    % \end{proof}
    
    
    % \begin{theorem}\label{thm:1-3}
    %   Let $\tilde{\mathcal{Y}}_{T_r}^{n}$ be the set of aperiodic-valid sequences of length $n$. The whole set $\tilde{\mathcal{Y}}_{T_r}^{n}$ 
    %   can be constructed by recursion with $\tilde{\mathcal{Y}}_{0, T_r}^{m}$ and $\tilde{\mathcal{Y}}_{0^\mathsf{c}, T_r}^{m}$, with 
    %   $m < n$ and $n \geq T_r$. Moreover, for $n < T_r$ we have $\tilde{\mathcal{Y}}_{T_r}^{n} = \{(y_1, \dots, y_n) : \sum_{i=1}^n y_i \in \{0, 1\} \}$, i.e.,
    %   either all term of the sequence are 0s, either there is exactly one 1 in the sequence.
    % \end{theorem}
    
    % \begin{proof}
    %   First of all, observe that for $n \leq T_r$, the only binary sequences of length $n$ such that there are at least $T_r$ consecutive 0s
    %   between two 1s, are the sequences with at most one 1, i.e., $\tilde{\mathcal{Y}}_{T_r}^{n} = \{(y_1, \dots, y_n) : \sum_{i=1}^n y_i \in \{0, 1\} \}$.
    %   Now suppose that $(y_1, \dots, y_n) \in \tilde{\mathcal{Y}}_{T_r}^{n}$, with $n \geq T_r$. Then $(y_1, \dots, y_{n-1}) \in \tilde{\mathcal{Y}}_{T_r}^{n-1}$. 
    %   In other words, any sequence in $\tilde{\mathcal{Y}}_{T_r}^{n}$ is a sequence in $\tilde{\mathcal{Y}}_{T_r}^{n-1}$ with a extra 
    %   term at its end. Hence, we can construct any set $\tilde{\mathcal{Y}}_{T_r}^{n}$ by recursion. 
    % \end{proof}

    % \begin{theorem} \label{thm:1-4}
    %   Let $\tilde{\ell}_{0, T_r}^n$ and $\tilde{\ell}_{T_r}^n$ denote the lengths of the sets $\tilde{\mathcal{Y}}_{0, T_r}^n$ and 
    %   $\tilde{\mathcal{Y}}_{T_r}^n$, respectively. We have:
    %   \begin{equation}
    %     \tilde{\ell}_{0, T_r}^n = 
    %     \left\{
    %       \begin{array}{ll}
    %         0 & \mbox{if }  n < T_r, \\
    %         1 & \mbox{if } n = T_r, \\
    %         \tilde{\ell}_{T_r}^{n-T_r} & \mbox{otherwise}.
    %       \end{array}
    %     \right.  
    %   \end{equation}
    % \end{theorem}
    
    % \begin{proof}
    %   Clearly, if $n < T_r$, it is impossible to find $T_r$ consecutive 0s at the end of the sequence, and thus 
    %   $\tilde{\mathcal{Y}}_{0, T_r}^n = \emptyset$. If $n = T_r$, then the sequence $(0, \dots, 0)$ is the only sequence with $T_r$ 
    %   consecutive 0s at the end. Finally, for $n > T_r$, the number of aperiodic-valid sequence of size $n$ with $T_r$ consecutive 0s 
    %   at the end corresponds to the number of aperiodic-valid sequence of length $n - T_r$, and the proof is complete.
    % \end{proof}
    
    % \begin{theorem} \label{thm:1-5}
    %   Let $\tilde{\ell}_{T_r}^n$, $\tilde{\ell}_{0, T_r}^n$, and $\tilde{\ell}_{0^\mathsf{c}, T_r}^n$ denote the lengths 
    %   of $\tilde{\mathcal{Y}}_{T_r}^n$, $\tilde{\mathcal{Y}}_{0, T_r}^n$, and $\tilde{\mathcal{Y}}_{0^\mathsf{c}, T_r}^n$, respectively. 
    %   We have:
    %   \begin{equation}
    %     \tilde{\ell}_{0^\mathsf{c}, T_r}^{n} = \tilde{\ell}_{T_r}^n - \tilde{\ell}_{0, T_r}^n,
    %   \end{equation}
    %   with integers $n \geq 0$ and $T_r > 0$.
    % \end{theorem}
    
    % \begin{proof}
    %   Trivial.
    % \end{proof}
    
    \begin{theorem}  \label{thm:1-recursion}
      Let $\tilde{\ell}_{T_r}^n$ denotes the cardinality of $\tilde{\mathcal{Y}}_{T_r}^n$, with $n \in \Integers_{\geq 0}$ and $T_r \in \Integers_{> 0}$. We have:
      \begin{equation}
        \tilde{\ell}_{T_r}^{n} = 
        \left\{
          \begin{array}{ll}
            0 & \mbox{if } n = 0 \\
            2 & \mbox{if } n = 1 \\
            \tilde{\ell}_{T_r}^{n-1} + 1 & \mbox{if } 1 < n \leq T_r + 1 \\
            \tilde{\ell}_{T_r}^{n-1} + \tilde{\ell}_{T_r}^{n-T_r-1} & \mbox{otherwise}.
          \end{array}
        \right..
      \end{equation}
    \end{theorem}
    
    \begin{proof}
      If $n = 0$, it is obvious that $\tilde{\ell}_{T_r}^{0} = 0$. If $n = 1$, both $1$ and $0$ are sequences in $\tilde{\mathcal{Y}}_{T_r}^{1}$ and thus $\tilde{\ell}_{T_r}^{1} = 2$
      If $2 \leq n \leq T_r + 1$, there are $\tilde{\ell}_{T_r}^{n-1}$ sequences in $\tilde{\mathcal{Y}}_{T_r}^{n}$ with the form
      \begin{equation*}
        \underbrace{y_{1} \cdots y_{n-1}}_{\in \tilde{\mathcal{Y}}_{T_r}^{n-1}} 0,
      \end{equation*} 
      and 1 sequence with the form
      \begin{equation*}
        \overbrace{0 \cdots 0}^{\leq T_r} 1.
      \end{equation*}
      
      If $n \geq T_r + 2$, there are $\ell_{T_r}^{n-1}$ sequences in $\tilde{\mathcal{Y}}_{T_r}^{n}$ with the form
      \begin{equation*}
        \underbrace{y_{1} \cdots y_{n-1}}_{\in \tilde{\mathcal{Y}}_{T_r}^{n-1}} 0,
      \end{equation*} 
      and $\tilde{\ell}_{T_r}^{n-T_r-1}$ sequences with the form
      \begin{equation*}
        \underbrace{y_{1} \cdots y_{n-T_r-1}}_{\in \tilde{\mathcal{Y}}_{T_r}^{n-T_r-1}} \overbrace{0 \cdots 0}^{T_r} 1.
      \end{equation*} 
    \end{proof}

    \begin{theorem} \label{thm:1-main}
      Let $\tilde{\ell}_{T_r}^n$ denotes the cardinality of $\tilde{\mathcal{Y}}_{T_r}^n$, with $n \in \Integers_{\geq 0}$ and $T_r \in \Integers_{> 0}$ and let $\varphi_{T_r + 1, i} \in \Complexes$ 
      with $i \in \Nk{T_r + 1}$ be as defined in \Cref{def:golden_number}. Then 
      \begin{equation}
        \tilde{\ell}_{T_r}^{n} = 
        \left\{
          \begin{array}{ll}
            \sum_{i = 1}^{T_r + 1} \frac{\varphi_{T_r + 1, i}^{2T_r + n + 1}}
            {\varphi_{T_r + 1, i}^{T_r + 1} + T_r} & \mbox{if } n > 0 \\
            0 & \mbox{otherwise}
          \end{array}
        \right.,
      \end{equation}
      with $\ROC{\tilde{\ell}_{T_r}^{n}} = \{z \in \Complexes : |z| > \max_{i \in \Nk{T_r + 1}} |\varphi_{T_r + 1, i}|\}$.
    \end{theorem}

    \begin{proof}
      Inverting the Z-Transform of \Cref{thm:1-mainz}, we get 
      \begin{equation}
        \tilde{\ell}_{T_r}^{n} = 
        \left\{
          \begin{array}{ll}
            \sum_{i = 1}^{T_r + 1} \frac{\varphi_{T_r + 1, i}^{2T_r + n + 1}}
            {\varphi_{T_r + 1, i}^{T_r + 1} + T_r} & \mbox{if } n > 0 \\
            -1 + \sum_{i = 1}^{T_r + 1} \frac{\varphi_{T_r + 1, i}^{2T_r + n + 1}}
            {\varphi_{T_r + 1, i}^{T_r + 1} + T_r} & \mbox{if } n = 0 \\
            0 & \mbox{otherwise}
          \end{array}
        \right.,
      \end{equation}
      with $\ROC{\tilde{\ell}_{T_r}^{n}} = \{z \in \Complexes : |z| > \max_{i \in \Nk{T_r + 1}} |\varphi_{T_r + 1, i}|\}$.

      But because of \Cref{thm:1-recursion}, for $n = 0$, we have:
      \begin{equation}
        \tilde{\ell}_{T_r}^{n} = 
            -1 + \sum_{i = 1}^{T_r + 1} \frac{\varphi_{T_r + 1, i}^{2T_r + n + 1}}
            {\varphi_{T_r + 1, i}^{T_r + 1} + T_r} = 0,
      \end{equation}
      and substituting $p = T_r + 1$, we prove \Cref{cor:A-7} and complete the current proof.
    \end{proof}

    \begin{table}[!ht]
      \centering
      \begin{tabular}{*{11}{c}}
        \toprule
        & \multicolumn{10}{c}{$T_r$} \\
        $n$ & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ & $8$ & $9$ & $10$ \\
        \midrule
        1 & 2 & 2 & 2 & 2 & 2 & 2 & 2 & 2 & 2 & 2 \\
        2 & 3 & 3 & 3 & 3 & 3 & 3 & 3 & 3 & 3 & 3 \\
        3 & 5 & 4 & 4 & 4 & 4 & 4 & 4 & 4 & 4 & 4 \\
        4 & 8 & 6 & 5 & 5 & 5 & 5 & 5 & 5 & 5 & 5 \\
        5 & 13 & 9 & 7 & 6 & 6 & 6 & 6 & 6 & 6 & 6 \\
        6 & 21 & 13 & 10 & 8 & 7 & 7 & 7 & 7 & 7 & 7 \\
        7 & 34 & 19 & 14 & 11 & 9 & 8 & 8 & 8 & 8 & 8 \\
        8 & 55 & 28 & 19 & 15 & 12 & 10 & 9 & 9 & 9 & 9 \\
        9 & 89 & 41 & 26 & 20 & 16 & 13 & 11 & 10 & 10 & 10 \\
        10 & 144 & 60 & 36 & 26 & 21 & 17 & 14 & 12 & 11 & 11 \\
        11 & 233 & 88 & 50 & 34 & 27 & 22 & 18 & 15 & 13 & 12 \\
        12 & 377 & 129 & 69 & 45 & 34 & 28 & 23 & 19 & 16 & 14 \\
        13 & 610 & 189 & 95 & 60 & 43 & 35 & 29 & 24 & 20 & 17 \\
        14 & 987 & 277 & 131 & 80 & 55 & 43 & 36 & 30 & 25 & 21 \\
        15 & 1597 & 406 & 181 & 106 & 71 & 53 & 44 & 37 & 31 & 26 \\
        16 & 2584 & 595 & 250 & 140 & 92 & 66 & 53 & 45 & 38 & 32 \\
        17 & 4181 & 872 & 345 & 185 & 119 & 83 & 64 & 54 & 46 & 39 \\
        18 & 6765 & 1278 & 476 & 245 & 153 & 105 & 78 & 64 & 55 & 47 \\
        19 & 10946 & 1873 & 657 & 325 & 196 & 133 & 96 & 76 & 65 & 56 \\
        20 & 17711 & 2745 & 907 & 431 & 251 & 168 & 119 & 91 & 76 & 66 \\
        \bottomrule
      \end{tabular}
      \caption{$\tilde{\ell}_{T_r}^{n}$ for $0 < n \leq 20$ and $0 < T_r \leq 10$.}
      \label{tab:tlnTr}
    \end{table}

    Given a sample of $\tilde{\mathcal{Y}}_{T_r}^{n}$, it could also be interesting to know the probability 
    that it contains exactly $n_0$ zeros and $n_1$ ones. Let $\tilde{\mathcal{Y}}_{T_r}^{n_0, n_1}$ represent
    the set of sequences in $\tilde{\mathcal{Y}}_{T_r}^{n}$ with $n_0$ zeros and $n_1$ ones, $n_0 + n_1 = n$, $n_0, n_1 \geq 0$. 
    It can be formally expressed as
    \begin{equation}
      \tilde{\mathcal{Y}}_{T_r}^{n_0, n_1} = \left\{(y_1, \dots, y_{n}) \in \tilde{\mathcal{Y}}_{T_r}^{n} : \sum_{i=1}^n y_i = n_1, n = n_0 + n_1 \right\}.
    \end{equation}

    \begin{theorem}
      Let $\tilde{\ell}_{T_r}^{n_0,n_1}$ denotes the cardinality of $\tilde{\mathcal{Y}}_{T_r}^{n_0, n_1}$ with $n_0, n_1 \in \Integers_{\geq 0}$ and $T_r \in \Integers_{> 0}$. We have:
      \begin{equation}
        \tilde{\ell}_{T_r}^{n_0,n_1} = 
        \left\{
          \begin{array}{ll}
            \binom{n - T_r n_1 + T_r}{n_1} & \mbox{if } n_0 \geq T_r(n_1-1) \\
            0 & \mbox{otherwise}
          \end{array}
        \right.,
      \end{equation}
      with $n = n_0 + n_1$.
    \end{theorem}

    \begin{proof}
      First of all, notice that if $n_0 < T_r(n_1 - 1)$, it is not possible that there are at least $T_r$ zeros between two
      consecutives ones. Hence $\tilde{\ell}_{T_r}^{n_0,n_1} = 0$.
      Now assume $n_0 \geq T_r(n_1 - 1)$ and consider the following \emph{bijective mapping}:
      \begin{equation}
        \underbrace{\overbrace{0 \cdots 0}^{k_0 \geq 0} 1 \overbrace{0 \cdots 0}^{k_1 \geq T_r} 1 
        \cdots \overbrace{0 \cdots 0}^{k_{n_1-1}\geq T_r} 
        1 \overbrace{0 \cdots 0}^{k_{n_1} \geq 0}}_{\in \tilde{\mathcal{Y}}^n_{T_r}}
        \mapsto \overbrace{0 \cdots 0}^{k_0 \geq 0} 1 \overbrace{0 \cdots 0}^{k_1' \geq 0} 1 
        \cdots \overbrace{0 \cdots 0}^{k_{n_1-1}' \geq 0} 1 \overbrace{0 \cdots 0}^{k_{n_1} \geq 0} 
      \end{equation}
      with $k_0 + k_1 + \dots + k_{n_1} = n_0$ and $k_i' = k_i - T_r$ for $1 \leq i < n_1$. In other words, this mapping 
      maps any binary sequence in $\tilde{\mathcal{Y}}^{n_0, n_1}_{T_r}$ to another binary sequence of lenght $n - T_r (n_1 - 1)$
      with $n_0 - T_r (n_1 - 1)$ zeros and $n_1$ ones. Now, it suffices to notice that there exists  
      \begin{equation}
        \binom{n - T_r n_1 + T_r}{n_1}
      \end{equation}
      such sequences to complete the proof.
    \end{proof}

    \clearpage

    \begin{table}[!ht]
      \centering
      \begin{tabular}{*{13}{c}}
        \toprule
        & \multicolumn{11}{c}{$n_1$} & \\
        $n$ & $0$ & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ & $8$ & $9$ & $10$ & $\tilde{\ell^n_{T_r}}$\\
        \midrule
        $1$ & $1$ & $1$ & - & - & - & - & - & - & - & - & - & 2 \\
        $2$ & $1$ & $2$ & $0$ & - & - & - & - & - & - & - & - & 3 \\
        $3$ & $1$ & $3$ & $1$ & $0$ & - & - & - & - & - & - & - & 5 \\
        $4$ & $1$ & $4$ & $3$ & $0$ & $0$ & - & - & - & - & - & - & 8 \\
        $5$ & $1$ & $5$ & $6$ & $1$ & $0$ & $0$ & - & - & - & - & - & 13 \\
        $6$ & $1$ & $6$ & $10$ & $4$ & $0$ & $0$ & $0$ & - & - & - & - & 21\\
        $7$ & $1$ & $7$ & $15$ & $10$ & $1$ & $0$ & $0$ & $0$ & - & - & - & 34 \\
        $8$ & $1$ & $8$ & $21$ & $20$ & $5$ & $0$ & $0$ & $0$ & $0$ & - & - & 55 \\
        $9$ & $1$ & $9$ & $28$ & $35$ & $15$ & $1$ & $0$ & $0$ & $0$ & $0$ & - & 89 \\
        $10$ & $1$ & $10$ & $36$ & $56$ & $35$ & $6$ & $0$ & $0$ & $0$ & $0$ & $0$ & 144 \\
        \bottomrule
      \end{tabular}
      \caption{$\tilde{\ell}_{T_r}^{n_0,n_1}$ for $0 < n \leq 10$, $0 \leq n_1 \leq n$ and $T_r = 1$.}
      \label{tab:aperiodic_one_spike}
    \end{table}


    \begin{table}[!ht]
      \centering
      \begin{tabular}{*{13}{c}}
        \toprule
        & \multicolumn{11}{c}{$n_1$} & \\
        $n$ & $0$ & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ & $8$ & $9$ & $10$ & $\tilde{\ell^n_{T_r}}$\\
        \midrule
        $1$ & $1$ & $1$ & - & - & - & - & - & - & - & - & - & 2 \\
        $2$ & $1$ & $2$ & $0$ & - & - & - & - & - & - & - & - & 3 \\
        $3$ & $1$ & $3$ & $0$ & $0$ & - & - & - & - & - & - & - & 4 \\
        $4$ & $1$ & $4$ & $1$ & $0$ & $0$ & - & - & - & - & - & - & 6 \\
        $5$ & $1$ & $5$ & $3$ & $0$ & $0$ & $0$ & - & - & - & - & - & 9 \\
        $6$ & $1$ & $6$ & $6$ & $0$ & $0$ & $0$ & $0$ & - & - & - & - & 13 \\
        $7$ & $1$ & $7$ & $10$ & $1$ & $0$ & $0$ & $0$ & $0$ & - & - & - & 19 \\
        $8$ & $1$ & $8$ & $15$ & $4$ & $0$ & $0$ & $0$ & $0$ & $0$ & - & - & 28 \\
        $9$ & $1$ & $9$ & $21$ & $10$ & $0$ & $0$ & $0$ & $0$ & $0$ & $0$ & - & 41 \\
        $10$ & $1$ & $10$ & $28$ & $20$ & $1$ & $0$ & $0$ & $0$ & $0$ & $0$ & $0$ & 60 \\
        \bottomrule
      \end{tabular}
      \caption{$\tilde{\ell}_{T_r}^{n_0,n_1}$ for $0 < n \leq 10$, $0 \leq n_1 \leq n$ and $T_r = 2$.}
      \label{tab:aperiodic_two_spike}
    \end{table}


    \begin{table}[!ht]
      \centering
      \begin{tabular}{*{13}{c}}
        \toprule
        & \multicolumn{11}{c}{$n_1$} & \\
        $n$ & $0$ & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ & $8$ & $9$ & $10$ & $\tilde{\ell^n_{T_r}}$\\
        \midrule
        $1$ & $1$ & $1$ & - & - & - & - & - & - & - & - & - & 2 \\
        $2$ & $1$ & $2$ & $0$ & - & - & - & - & - & - & - & - & 3 \\
        $3$ & $1$ & $3$ & $0$ & $0$ & - & - & - & - & - & - & - & 4 \\
        $4$ & $1$ & $4$ & $0$ & $0$ & $0$ & - & - & - & - & - & - & 5 \\
        $5$ & $1$ & $5$ & $1$ & $0$ & $0$ & $0$ & - & - & - & - & - & 7 \\
        $6$ & $1$ & $6$ & $3$ & $0$ & $0$ & $0$ & $0$ & - & - & - & - & 10\\
        $7$ & $1$ & $7$ & $6$ & $0$ & $0$ & $0$ & $0$ & $0$ & - & - & - & 14 \\
        $8$ & $1$ & $8$ & $10$ & $0$ & $0$ & $0$ & $0$ & $0$ & $0$ & - & - & 19 \\
        $9$ & $1$ & $9$ & $15$ & $1$ & $0$ & $0$ & $0$ & $0$ & $0$ & $0$ & - & 26 \\
        $10$ & $1$ & $10$ & $21$ & $4$ & $0$ & $0$ & $0$ & $0$ & $0$ & $0$ & $0$ & 36 \\
        \bottomrule
      \end{tabular}
      \caption{$\tilde{\ell}_{T_r}^{n_0,n_1}$ for $0 < n \leq 10$, $0 \leq n_1 \leq n$ and $T_r = 3$.}
      \label{tab:aperiodic_three_spike}
    \end{table}

    
    % ---------------------------------
    
    \clearpage
    \section{Firing signals with cycles}
    
    We now consider firing signals of size $n \in \Integers_{\geq 0}$ with refractory period $T_r \in \Integers_{\geq 0}$ and cycled constrained. 
    Those signals can be represented by binary sequences of length $n$ such that there are at least $T_r$ zeros between two consecutive ones
    even between the last one and the first one of the sequence. Let $\mathcal{Y}_{T_r}^n$
    represent the set of such sequences. We formally define this set as

        % Mathematically, we can formulate the set of all valid sequences as :
    % \begin{equation}
    %   \begin{split}
    %     \mathcal{Y}_{T_r}^n & = \{ (y_1, \dots, y_n) \in \{0, 1\}^n : \\
    %     & \sum_{k=0}^{T_r} y_{i+k\omod{n}{1}} \in \{0, 1\}, i \in \Nk{n}\},
    %   \end{split}
    % \end{equation}
    % where we used the modulo with offset defined by $m \omod{n}{d} = m \mod{n} + d$, for $m$, $n$ and $d \in \Integers$.
    % Let $\ell_{T_r}^n$ be the number of such sequences, i.e., $\ell_{T_r}^n = 
    % |\mathcal{Y}_{T_r}^n|$.
    
    \begin{equation}
        \mathcal{Y}_{T_r}^n = \left\{ (y_1, \dots, y_n) \in \{0, 1\}^n : \sum_{m=0}^{T_r} y_{(k+m \mod{n}) + 1} \in \{0, 1\}, k \in \Nk{n} \right\}.
    \end{equation}
    
    Obviously, if $T_r = 0$, $\mathcal{Y}_{T_r}^n$ simplifies to 
    \begin{equation}
      \mathcal{Y}_{T_r}^n = \{0, 1\}^n,
    \end{equation}
    and this trivial case is irrelevant for our purpose. That is why, from now on, we further assume $T_r > 0$.

    
    % \begin{theorem}\label{thm:2-1}
    %   Let $\{y_1, \dots, y_n\}$ be a binary sequence of length $n$. If $\{y_1, \dots, y_n\} \in \mathcal{Y}_{0, T_r}^n$, then 
    %   $\{y_1, \dots, y_n, 0\} \in \mathcal{Y}_{T_r}^{n+1}$ and $\{y_1, \dots, y_n, 1\} \in \mathcal{Y}_{T_r}^{n+1}$.
    % \end{theorem}
    
    % \begin{proof}
    %   Let $\{y_1, \dots, y_n\}$ be a binary sequence of length $n$ such that $\{y_1, \dots, y_n\} \in \mathcal{Y}_{0, T_r}^n$. 
    %   Clearly, adding a 0 at the end of an arbitrary valid sequence does not affect its validity. Thus 
    %   $\{y_1, \dots, y_n, 0\} \in \mathcal{Y}_{T_r}^{n+1}$. Moreover, if the sequence starts with $T_r$ 0s and ends with $T_r$ 0s, 
    %   we can also add a 1 to this sequence as this 1 is preceeded by $T_r$ 0s and followed by $T_r$ 0s. The new sequence is still 
    %   valid and $\{y_1, \dots, y_n, 1\} \in \mathcal{Y}_{T_r}^{n+1}$.
    % \end{proof}
    
    % \begin{theorem}\label{thm:2-2}
    %   Let $\{y_1, \dots, y_n\}$ be a binary sequence of length $n$. If $\{y_1, \dots, y_n\} \in \mathcal{Y}_{0^\mathsf{c}, T_r}^n$, then 
    %   $\{y_1, \dots, y_n, 0\} \in \mathcal{Y}_{T_r}^{n+1}$ but $\{y_1, \dots, y_n, 1\} \not \in \mathcal{Y}_{T_r}^{n+1}$.
    % \end{theorem}
    
    % \begin{proof}
    %   Let $\{y_1, \dots, y_n\}$ be a binary sequence of length $n$ such that $\{y_1, \dots, y_n\} \in \mathcal{Y}_{0^\mathsf{c}, T_r}^n$. 
    %   Clearly, adding a 0 at the end of an arbitrary valid sequence does not affect its validity. Thus 
    %   $\{y_1, \dots, y_n, 0\} \in \mathcal{Y}_{T_r}^{n+1}$. However, if we add a 1 at the end of this sequence, there is a 1 in the 
    %   $T_r$ preceeding terms or in the $T_r$ following terms and the sequence is not valid anymore. Thus 
    %   $\{y_1, \dots, y_n, 1\} \not \in \mathcal{Y}_{T_r}^{n+1}$.
    % \end{proof}
    
    % \begin{theorem}\label{thm:2-3}
    %   Let $\{y_1, \dots, y_n\}$ be a binary sequence of length $n$. If $\{y_1, \dots, y_n\} \in \mathcal{Y}_{y|0, T_r}^n$, then 
    %   $\{y_1, \dots, y_n, 0\} \in \mathcal{Y}_{T_r}^{n+1}$ but $\{y_1, \dots, y_n, 1\} \not \in \mathcal{Y}_{T_r}^{n+1}$.
    % \end{theorem}
    
    % \begin{proof}
    %   Let $\{y_1, \dots, y_n\}$ be a binary sequence of length $n$ such that $\{y_1, \dots, y_n\} \in \mathcal{Y}_{y|0, T_r}^n$. 
    %   By definition of $\mathcal{Y}_{y|0, T_r}^n$, we have that $\{y_1, \dots, y_n, 0\} \in \mathcal{Y}_{T_r}^{n+1}$. However, 
    %   if $\{y_1, \dots, y_n\}$ is not valid, then adding a 1 at its end will not change it and 
    %   $\{y_1, \dots, y_n, 1\} \not \in \mathcal{Y}_{T_r}^{n+1}$.
    % \end{proof}
    
    % \begin{theorem}\label{thm:2-4}
    %   Let $\mathcal{Y}_{T_r}^{n}$ be the set of valid sequences of length $n$. The whole set $\mathcal{Y}_{T_r}^{n}$ 
    %   can be constructed from $\mathcal{Y}_{0, T_r}^{n-1}$, $\mathcal{Y}_{0^\mathsf{c}, T_r}^{n-1}$, and $\mathcal{Y}_{y|0, T_r}^{n-1}$, 
    %   with $n > 1$. Moreover, for $n = 1$ we have $\mathcal{Y}_{T_r}^{n} = \{(0)\}$.
    % \end{theorem}
    
    % \begin{proof}
    %   First of all, observe that for $n = 1$, the only binary sequences of length $n$ such that there are at least $T_r$ consecutive 0s
    %   between two 1s, and with periodicity condition, is the sequence where all terms are 0s, i.e., $(y_1) = (0)$. This sequence can be 
    %   obtained $\mathcal{Y}_{y|0, T_r}^{0} = \emptyset$ by adding one 0 at the end. Now suppose that 
    %   $(y_1, \dots, y_n) \in \tilde{\mathcal{Y}}_{T_r}^{n}$, with $n > 1$. Then, we have to consider two cases:
    %   \begin{enumerate}
    %     \item $(y_1, \dots, y_{n-1})$ was already a valid sequence. In such case we have 
    %     $(y_1, \dots, y_{n-1}) \in \tilde{\mathcal{Y}}_{0, T_r}^{n-1}$ or 
    %     $(y_1, \dots, y_{n-1}) \in \tilde{\mathcal{Y}}_{0^\mathsf{c}, T_r}^{n-1}$
    %     \item $(y_1, \dots, y_{n-1})$ was not a valid sequence. In this case $y_n = 0$ and 
    %     $(y_1, \dots, y_{n-1}) \in \mathcal{Y}_{y|0, T_r}^{n-1}$, necessarily.
    %   \end{enumerate}
    % \end{proof}
  
    
    % \begin{theorem}\label{thm:2-5}
    %   Let $\ell_{0, T_r}^n$ be the length of $\mathcal{Y}_{0, T_r}^n$ and $\tilde{\ell}_{T_r}^n$ be the length of 
    %   $\tilde{\mathcal{Y}}_{T_r}^n$. We have:
    %   \begin{equation}
    %     \ell_{0, T_r}^n = 
    %     \left\{
    %       \begin{array}{ll}
    %         0 & \mbox{if } n < T_r, \\
    %         1 & \mbox{if } T_r \leq n < 2 T_r + 1, \\
    %         \tilde{\ell}_{T_r}^{n-2T_r} & \mbox{otherwise}.
    %       \end{array}
    %     \right.,
    %   \end{equation}
    %   with integers $n \geq 0$ and $T_r > 0$.
    % \end{theorem}
    
    % \begin{proof}
    %   Clearly, if $n < T_r$, it is impossible to find $T_r$ consecutive 0s at the end and at the begining of the sequence. If 
    %   $T_r \leq n < 2T_r + 1$, the only sequence with $T_r$ consecutive 0s at the and at the begining of the sequence is 
    %   $(0, \dots, 0)$. Indeed, suppose there exists $j \in \{1, \dots, n\}$ such that $y_j = 1$ in $(y_1, \dots, y_n)$. If the sequence 
    %   is valid, there are at least $T_r$ consecutive 0s before and after the $j$-th term, and the sequence has length $2T_r + 1$. This is 
    %   is contradiction. Finally, if $n \geq 2 T_r + 1$, finding the number of valid sequences of length $n$, with $T_r$ consecutive 
    %   0s at the end and at the begining of the sequence, is the same problem as finding the number of sequences of length $n - 2T_r$ 
    %   without the periodicity condition. It yields $\ell_{0, T_r}^n = \tilde{\ell}_{T_r}^{n-2T_r}$ for any 
    %   $n \geq 2T_r + 1$.
    % \end{proof}
    
    % \begin{theorem}\label{thm:2-6}
    %   Let $\ell_{T_r}^n$, $\ell_{0, T_r}^n$, and $\ell_{0^\mathsf{c}, T_r}^n$ denote the lengths 
    %   of $\mathcal{Y}_{T_r}^n$, $\mathcal{Y}_{0, T_r}^n$, and $\mathcal{Y}_{0^\mathsf{c}, T_r}^n$, respectively. 
    %   We have:
    %   \begin{equation}
    %     \ell_{T_r, 0^\mathsf{c}}^{n} = \ell_{T_r}^n - \ell_{0, T_r}^n,
    %   \end{equation}
    %   with integers $n \geq 0$ and $T_r > 0$.
    % \end{theorem}
    
    % \begin{proof}
    %   Trivial.
    % \end{proof}
    
    % \begin{theorem}\label{thm:2-7}
    %   Let $\ell_{y|0, T_r}^n$ be the length of $\mathcal{Y}_{y|0, T_r}^n$ and $\tilde{\ell}_{T_r}^n$ be the length of 
    %   $\tilde{\mathcal{Y}}_{T_r}^n$. We have:
    %   \begin{equation}
    %     \ell_{y|0, T_r}^n = 
    %     \left\{
    %       \begin{array}{ll}
    %         1 & \mbox{if } n = 0, \\
    %         0 & \mbox{if } 0 < n < T_r, \\
    %         T_r & \mbox{if } n = T_r, \\
    %         0 & \mbox{if } T_r < n < 2T_r + 1, \\
    %         T_r & \mbox{if } 2T_r + 1 \leq n < 3T_r + 2, \\
    %         T_r \tilde{\ell}_{T_r}^{\tilde{n}} & \mbox{otherwise}.
    %       \end{array}
    %     \right.,
    %   \end{equation}
    %   with $\tilde{n} = n-3T_r-1$ and integers $n \geq 0$, $T_r > 0$.
    % \end{theorem}
    
    
    % \begin{proof}
    %   If $n = 0$, $\mathcal{Y}_{y|0, T_r}^n = \{()\}$, where $()$ denotes an empty sequence. This sequence is not valid but adding a 0,
    %   we get the valid sequence $(0)$ and thus $\ell_{y|0, T_r}^0 = 1$. Now, we will consider the non-trivial case, i.e., $n > 0$.
    %   Let $(y_1, \dots, y_n)$ be a sequence in $\mathcal{Y}_{y|0, T_r}^n$ and denote $N_0$ and $N_1$ the number of 0s and 1s respectively
    %   in the sequence. Let $T_i, i \in \{1, \dots, N_1\}$ be the number of consecutive 0s between two adjacent 1s, i.e.,
    %   \begin{equation}
    %     \overbrace{0 \cdots 0}^{T_1}1\overbrace{0 \cdots 0}^{T_2}1 \cdots 1\overbrace{0 \cdots 0}^{T_{N_1}}1.
    %   \end{equation}
    
    %   We start with $n \leq T_r$. If $N_1 = 0$, then the sequence is valid and $(y_1, \dots, y_n) \not \in \mathcal{Y}_{y|0, T_r}^n$.
    %   If $N_1 > 1$, since adding a 0 at the right position would lead to a valid sequence, then the sequence should have the form 
    %   (up to some rolls):
    %   \begin{equation}
    %     y_{1} \cdots y_{n - 2T_r - 3} 1 \overbrace{0 \cdots 0}^{T_r} 1 \overbrace{0 \cdots 0}^{T_r - 1},
    %   \end{equation}
    %   which is not possible since $n \leq T_r$. Thus, $N_1 = 1$ necessarily and the sequence has the form (up to some rolls):
    %   \begin{equation}
    %     1 \overbrace{0 \cdots 0}^{T_1}.
    %   \end{equation}
    %   It is easy to see that if $n < T_r$, then $T_1 < T_r - 1$ and adding a 0 to the sequence does not make it valid. Thus 
    %   $\mathcal{Y}_{y|0, T_r}^n = \emptyset$ in this case. However, if $n = T_r$, then $T_1 = T_r - 1$ and adding a zero to the 
    %   sequence yields to a valid sequence. As there are exactly $T_r$ sequence of length $T_r$ containing a unique 1, we have 
    %   $\ell_{y|0, T_r}^{T_r} = T_r$.
    
    %   Now, suppose $T_r < n < 2T_r + 1$. If $N_1 < 2$, then the sequence is valid and 
    %   $(y_1, \dots, y_n) \not \in \mathcal{Y}_{y|0, T_r}^n$. If $N_1 > 2$, then it has the form (up to some rolls):
    %   \begin{equation}
    %     y_{1} \cdots y_{n - 3T_r - 4} 1 \overbrace{0 \cdots 0}^{T_r} 1 \overbrace{0 \cdots 0}^{T_r} 1 \overbrace{0 \cdots 0}^{T_r - 1},
    %   \end{equation}
    %   which is not possible since $n < 2T_r + 1$. Thus, $N_1 = 2$ necessarily and the sequence has the form (up to some rolls):
    %   \begin{equation}
    %     1 \overbrace{0 \cdots 0}^{T_1} 1 \overbrace{0 \cdots 0}^{T_2},
    %   \end{equation}
    %   with $T_1 \geq T_r$ and $T_2 = T_r - 1$. But this is a contradiction with $n < 2T_r + 1$ and such sequence 
    %   does not exist.
    
    %   Then, consider $2T_r + 1 \leq n < 3T_r + 2$. If $N_1 < 2$, the sequence is valid and 
    %   $(y_1, \dots, y_n) \not \in \mathcal{Y}_{y|0, T_r}^n$. If $N_1 > 2$, then it has the form (up to some rolls):
    %   \begin{equation}
    %     y_{1} \cdots y_{n - 3T_r - 4} 1 \overbrace{0 \cdots 0}^{T_r} 1 \overbrace{0 \cdots 0}^{T_r} 1 \overbrace{0 \cdots 0}^{T_r - 1},
    %   \end{equation}
    %   which is not possible since $n < 3T_r + 2$. Thus, $N_1 = 2$ necessarily and the sequence has the form (up to some rolls):
    %   \begin{equation}
    %     1 \overbrace{0 \cdots 0}^{T_1} 1 \overbrace{0 \cdots 0}^{T_2},
    %   \end{equation}
    %   with $T_1 \geq T_r$ and $T_2 = T_r - 1$ which is possible since $n \geq 2T_r + 1$. Such sequence can be rolled $T_r - 1$ times
    %   and yields each time a unique sequence in $\mathcal{Y}_{y|0, T_r}^n$. Thus we get $\ell_{y|0, T_r}^n = T_r$ for 
    %   $2T_r + 1 \leq n < 3T_r + 2$. 
    
    %   Finally, suppose $n \geq 3T_r + 2$. This sequence has the form (up to some rolls):
    %   \begin{equation}
    %     y_1 y_2 \cdots y_{n - T_r + 1} y_{n - T_r + 1}\overbrace{0 \cdots 0}^{T_{N_1}}.
    %   \end{equation}
    %   If $(y_1, \dots, y_n, 0)$ is valid but $(y_1, \dots, y_n)$ is not, we necessarily have $T_{N_1} = T_r - 1$ and 
    %   $y_1 = y_{n - T_r + 1} = 1$. Since $n \geq 3 T_r + 2$, we also necessarily have 
    %   $y_2 = \dots = y_{T_r + 2} = y_{n - 2T_r} = \dots = y_{n - T_r} = 0$. Thus the sequence
    %   has the form (up to some rolls):
    %   \begin{equation}\label{eq:seq}
    %     1 \overbrace{0 \cdots 0}^{T_r} \underbrace{y_{T_r + 2} \cdots y_{n - 2T_r - 1}}_{n - 3T_r - 1} \overbrace{0 \cdots 0}^{T_r} 1 
    %     \overbrace{0 \cdots 0}^{T_r - 1}.
    %   \end{equation}
    %   Since $y_{T_r + 2}$ is preceeded by $T_r$ consecutive 0s and $y_{n - 2T_r - 1}$ is followed by $T_r$ consecutive 0s, counting the 
    %   number of sequences of the form~\ref{eq:seq} is equivalent to counting the size of $\tilde{\ell}_{T_r}^{n - 3T_r - 1}$.
    %   Such sequence can only be rolled $T_r - 1$ times to each time yield a unique sequence in $\mathcal{Y}_{y|0, T_r}^n$. Hence, 
    %   $\tilde{\mathcal{Y}}_{T_r}^n = T_r \tilde{\ell}_{T_r}^{\tilde{n}}$ for any $n \geq 3T_r + 2$.
    %   \end{proof}

      % \begin{theorem} \label{thm:2-recursion}
      %   Let $\ell_{T_r}^n$, $\ell_{0, T_r}^n$, and $\ell_{y|0, T_r}^n$
      %   be the lengths of $\mathcal{Y}_{T_r}^n$, $\mathcal{Y}_{0, T_r}^n$, and 
      %   $\mathcal{Y}_{y|0, T_r}^n$, respectively. We have:
      %   \begin{equation}
      %     \ell_{T_r}^{n} = 
      %     \left\{
      %       \begin{array}{ll}
      %         0 & \mbox{if } n = 0, \\
      %         \ell_{T_r}^{n-1} + \ell_{0, T_r}^{n-1} + \ell_{y|0, T_r}^{n-1} & \mbox{otherwise}.
      %       \end{array}
      %     \right.  
      %   \end{equation}
      %   with integers $n \geq 0$ and $T_r > 0$.
      % \end{theorem}

      \begin{theorem} \label{thm:2-recursion}
        Let $\ell_{T_r}^n$ denotes the cardinality of $\mathcal{Y}_{T_r}^n$, with $n \in \Integers_{\geq 0}$ and $T_r \in \Integers_{> 0}$. We have:
        \begin{equation}
          \ell_{T_r}^{n} = 
          \left\{
            \begin{array}{ll}
              0 & \mbox{if } n = 0 \\
              \ell_{T_r}^{n-1} + 1 & \mbox{if } n = 1 \\
              \ell_{T_r}^{n-1} & \mbox{if } 2 \leq n \leq T_r \\
              \ell_{T_r}^{n-1} + 1 + T_r & \mbox{if } n = T_r + 1 \\
              \ell_{T_r}^{n-1} + 1 & \mbox{if } T_r + 2 \leq n \leq 2T_r + 1 \\
              \ell_{T_r}^{n-1} + \tilde{\ell}_{T_r}^{n-2T_r-1} + T_r & \mbox{if } 2T_r + 2 \leq n \leq 3T_r + 2 \\
              \ell_{T_r}^{n-1} + \tilde{\ell}_{T_r}^{n-2T_r-1} + T_r \tilde{\ell}_{T_r}^{n-3T_r-2} & \mbox{otherwise} \\
            \end{array}
          \right..
        \end{equation}
      \end{theorem}
      
      \begin{proof}
        If $n = 0$, it is obvious that $\ell_{T_r}^{n} = 0$. 
        If $n = 1$, the only periodic-valid sequence is the one containing one zero and zero one and $\ell_{T_r}^{n} = \ell_{T_r}^{n-1} + 1 = 0 + 1$.
        If $2 \leq n \leq T_r$, there are $\ell_{T_r}^{n-1}$ sequences in $\mathcal{Y}_{T_r}^{n}$ with the form
          \begin{equation*}
            \underbrace{y_{1} \cdots y_{n-1}}_{\in \mathcal{Y}_{T_r}^{n-1}} 0.
          \end{equation*} 
        
        If $n = T_r + 1$, there are $\ell_{T_r}^{n-1}$ sequences in $\mathcal{Y}_{T_r}^{n}$ with the form
          \begin{equation*}
            \underbrace{y_{1} \cdots y_{n-1}}_{\in \mathcal{Y}_{T_r}^{n-1}} 0,
          \end{equation*} 
        $T_r$ sequences in $\mathcal{Y}_{T_r}^{n}$ with the form
        \begin{equation*}
          \underbrace{\overbrace{0 \cdots 0}^{k_1 \geq 0} 1 \overbrace{0 \cdots 0}^{k_2 \geq 0}}_{\not \in \mathcal{Y}_{T_r}^{n-1}} 0,
        \end{equation*} 
        with $k_1 + k_2 = k = T_r - 1$, and 1 sequence with the form 
        \begin{equation*}
          \overbrace{0 \cdots 0}^{T_r} 1.
        \end{equation*} 

        If $T_r + 2 \leq n \leq 2T_r + 1$, there are $\ell_{T_r}^{n-1}$ sequences in $\mathcal{Y}_{T_r}^{n}$ with the form
        \begin{equation*}
          \underbrace{y_{1} \cdots y_{n-1}}_{\in \mathcal{Y}_{T_r}^{n-1}} 0,
        \end{equation*} 
        and $1$ sequence with the form
        \begin{equation*}
          \overbrace{0 \cdots 0}^{n - 1 > T_r} 1.
        \end{equation*} 
        
        
        If $2T_r + 2 \leq n \leq 3T_r + 2$, there are $\ell_{T_r}^{n-1}$ sequences in $\mathcal{Y}_{T_r}^{n}$ with the form
        \begin{equation*}
          \underbrace{y_{1} \cdots y_{n-1}}_{\in \mathcal{Y}_{T_r}^{n-1}} 0,
        \end{equation*} 
        $T_r$ sequences with the form
        \begin{equation*}
          \underbrace{\overbrace{0 \cdots 0}^{k_1 \geq 0} 1 \overbrace{0 \cdots 0}^{n-T_r-2 \geq T_r} 1 \overbrace{0 \cdots 0}^{k_2 \geq 0}}_{\not \in \mathcal{Y}_{T_r}^{n-1}} 0,
        \end{equation*} 
        with $k_1 + k_2 = k = T_r - 1$ and $\tilde{\ell}_{T_r}^{n-2T_r-1}$ sequences with the form
        \begin{equation*}
          \overbrace{0 \cdots 0}^{T_r} \underbrace{y_{T_r+1} \cdots y_{n-T_r-1}}_{\in \tilde{\mathcal{Y}}_{T_r}^{n-2T_r-1}} \overbrace{0 \cdots 0}^{T_r} 1.
        \end{equation*} 

        If $n \geq 3T_r + 3$, the are $\ell_{T_r}^{n-1}$ sequences in $\mathcal{Y}_{T_r}^{n}$ with the form 
        \begin{equation}
          \underbrace{y_{1} \cdots y_{n-1}}_{\in \mathcal{Y}_{T_r}^{n-1}} 0,
        \end{equation} 
        $T_r \tilde{\ell}_{T_r}^{n-3T_r-2}$ sequences with the form 
        \begin{equation}
          \underbrace{\overbrace{0 \cdots 0}^{k_1 \geq 0} 1 \overbrace{0 \cdots 0}^{T_r} 
          \underbrace{y_{k_1+T_r+T_r} \cdots y_{n-k_2-T_r-1}}_{\in \tilde{\mathcal{Y}}_{T_r}^{n-3T_r-2}}
          \overbrace{0 \cdots 0}^{T_r} 1 \overbrace{0 \cdots 0}^{k_2 \geq 0}}_{\not \in \mathcal{Y}_{T_r}^{n-1}} 0,
        \end{equation} 
        with $k_1 + k_2 = k = T_r-1$, and $\tilde{\ell}_{T_r}^{n-2T_r-1}$ sequences with the form 
        \begin{equation}
          \overbrace{0 \cdots 0}^{T_r} 
          \underbrace{y_{T_r+1} \cdots y_{n-T_r-1}}_{\in \tilde{\mathcal{Y}}_{T_r}^{n-2T_r-1}}
          \overbrace{0 \cdots 0}^{T_r} 1.
        \end{equation} 
      \end{proof}

    % \begin{theorem} \label{thm:2-mainz}
    %   Let $\ell_{T_r}^{n}$ be as introduced before, with $T_r > 0$ and $n \geq 0$. 
    %   The Z-transform of $\ell_{T_r}^{n}$ is given by:
    %   \begin{align}
    %     \mathcal{L}_{T_r}(z) 
    %     & = z^{-1} \frac{z}{z-1} + z^{-T_r} \frac{z}{(z-1)^2} + T_r z^{-T_r-1} \frac{z}{z-1}\\
    %     \nonumber & + z^{-2T_r} \frac{\tilde{\mathcal{L}}_{T_r}(z)}{z-1} - z^{-2T_r-1} \frac{z}{(z-1)^2} + T_r z^{-2T_r-2} \frac{z}{(z-1)^2} \\
    %     \nonumber & + T_r z^{-3T_r-1} \frac{\tilde{\mathcal{L}}_{T_r}(z)}{z-1} - T_r z^{-3T_r-2} \frac{z}{(z-1)^2}.
    %   \end{align}
    %   with $\varphi_{T_r + 1, i}$ with $i \in \Nk{T_r + 1}$ as defined above.
    % \end{theorem}

  %   \begin{proof}
  %     Combining \Cref{thm:2-5,thm:2-7,thm:2-recursion}, we can express $\ell_{T_r}^{n}$ as:
  %     \begin{align}
  %       \ell_{T_r}^{n} 
  %       & = \sigma[n-1] \ell_{T_r}^{n-1} \\
  %       \nonumber & + \sigma[n-T_r-1]\sigma[-n+1+2T_r] \\
  %       \nonumber & + \sigma[n-2T_r-2]\tilde{\ell}_{T_r}^{n-1-2T_r} \\
  %       \nonumber & + \delta[n-1] \\
  %       \nonumber & + T_r \delta[n-1-T_r] \\
  %       \nonumber & + T_r \sigma[n-2T_r-2]\sigma[-n+3T_r+2] \\
  %       \nonumber & + T_r \sigma[n-3T_r-3] \tilde{\ell}_{T_r}^{n-3T_r-2}
  %   \end{align}
  %   whose Z-Transform is given by:
  %   \begin{align}
  %     \mathcal{L}_{T_r}(z) & \eqdef \sum_{n \geq 1} \ell_{T_r}^{n}z^{-n}\\
  %     & = \sum_{n \geq 1} \sigma[n-1] \ell_{T_r}^{n-1}z^{-n} \\
  %     \nonumber & + \sum_{n \geq 1} \sigma[n-T_r-1]\sigma[-n+1+2T_r]z^{-n} \\
  %     \nonumber & + \sum_{n \geq 1} \sigma[n-2T_r-2]\tilde{\ell}_{T_r}^{n-2T_r-1}z^{-n} \\
  %     \nonumber & + \sum_{n \geq 1} \delta[n-1]z^{-n} \\
  %     \nonumber & + T_r \sum_{n \geq 1} \delta[n-1-T_r]z^{-n} \\
  %     \nonumber & + T_r \sum_{n \geq 1} \sigma[n-2T_r - 2]\sigma[-n+2+3T_r]z^{-n} \\
  %     \nonumber & + T_r \sum_{n \geq 1} \sigma[n-3T_r-3] \tilde{\ell}_{T_r}^{n-3T_r-2}z^{-n} \\
  %     % & = z^{-1} \mathcal{L}_{T_r}(z) \\
  %     % \nonumber & + \sum_{n = T_r + 1}^{2T_r + 1} z^{-n} \\
  %     % \nonumber & + z^{-2T_r-1}\tilde{\mathcal{L}}_{T_r}(z) \\
  %     % \nonumber & + z^{-1} \\
  %     % \nonumber & + T_r z^{-T_r-1} \\
  %     % \nonumber & + T_r \sum_{n = 2T_r+2}^{3T_r + 2} z^{-n} \\
  %     % \nonumber & + T_r z^{-3T_r-2} \tilde{\mathcal{L}}_{T_r}(z) \\
  %     & = z^{-1} \mathcal{L}_{T_r}(z) \\
  %     \nonumber & + \frac{z^{-T_r} - z^{-2T_r-1}}{z-1} \\
  %     \nonumber & + z^{-2T_r-1}\tilde{\mathcal{L}}_{T_r}(z)\\
  %     \nonumber & + z^{-1} \\
  %     \nonumber & + T_r z^{-T_r-1} \\
  %     \nonumber & + T_r \frac{z^{-2T_r-1} - z^{-3T_r-2}}{z-1} \\
  %     \nonumber & + T_r z^{-3T_r-2} \tilde{\mathcal{L}}_{T_r}(z)
  %   \end{align}
  %   and thus:
  %   \begin{align}
  %     \mathcal{L}_{T_r}(z) 
  %     & = z^{-1} \frac{z}{z-1} \\
  %     \nonumber & + z^{-T_r} \frac{z}{(z-1)^2} \\
  %     \nonumber & + T_r z^{-T_r-1} \frac{z}{z-1}\\
  %     \nonumber & + z^{-2T_r} \frac{\tilde{\mathcal{L}}_{T_r}(z)}{z-1} \\
  %     \nonumber & - z^{-2T_r-1} \frac{z}{(z-1)^2} \\
  %     \nonumber & + T_r z^{-2T_r-2} \frac{z}{(z-1)^2} \\
  %     \nonumber & + T_r z^{-3T_r-1} \frac{\tilde{\mathcal{L}}_{T_r}(z)}{z-1} \\
  %     \nonumber & - T_r z^{-3T_r-2} \frac{z}{(z-1)^2}
  %   \end{align}
  % \end{proof}

  \begin{theorem} \label{thm:2-main}
    Let $\ell_{T_r}^{n}$ be as introduced before, with $n \in \Integers_{\geq 0}$ and $T_r \in \Integers_{> 0}$. Then:
    \begin{equation}
      \ell_{T_r}^{n} = 
      \left\{
        \begin{array}{ll}
          0 & \mbox{if } n \leq 0, \\
          1 & \mbox{if } 1 \leq n \leq T_r, \\
          n+1 & \mbox{if } T_r + 1 \leq n \leq 2T_r, \\
          \sum_{i=1}^{T_r + 1} \frac{\varphi_{T_r + 1, i}^{T_r + 1 + n}}
          {\varphi_{T_r + 1, i}^{T_r + 1} + T_r} - 2T_r^2 + n T_r 
          & \mbox{if } 2T_r + 1 \leq n \leq 3T_r + 1, \\
          \sum_{i=1}^{T_r + 1} \varphi_{T_r + 1, i}^n
          & \mbox{if } n > 3T_r + 1. \\
        \end{array}
      \right.  
    \end{equation}
    with $\ROC{\ell_{T_r}^n} = \{z \in \Complexes: |z| > \max_{i \in \Nk{T_r + 1}} |\varphi_{T_r + 1, i}|\}$.
  \end{theorem}

  \begin{proof}
    Inverting the Z-Transform of \Cref{thm:2-mainz}, we get 
    \begin{equation}
      \ell_{T_r}^{n} = 
      \left\{
        \begin{array}{ll}
          0 & \mbox{if } n \leq 0, \\
          1 & \mbox{if } 1 \leq n \leq T_r, \\
          n+1 & \mbox{if } T_r + 1 \leq n \leq 2T_r-1, \\
          T_r + \sum_{i=1}^{T_r + 1} \frac{\varphi_{T_r + 1, i}^{3T_r + 1}}
          {\varphi_{T_r + 1, i}^{T_r + 1} + T_r} & \mbox{if } n = 2T_r, \\
          % T_r + \sum_{i=1}^{T_r + 1} \frac{\varphi_{T_r + 1, i}^{3T_r + 2}}
          % {\varphi_{T_r + 1, i}^{T_r + 1} + T_r} & \mbox{if } n = 2T_r+1, \\
          T_r n - 2T_r ^2 + \sum_{i=1}^{T_r + 1} \frac{\varphi_{T_r + 1, i}^{T_r + 1 + n}}
          {\varphi_{T_r + 1, i}^{T_r + 1} + T_r} & \mbox{if } 2T_r+1 \leq n \leq 3T_r, \\
          \sum_{i=1}^{T_r + 1} \frac{\varphi_{T_r + 1, i}^{4T_r + 2}}
          {\varphi_{T_r + 1, i}^{T_r + 1} + T_r} + T_r \sum_{i=1}^{T_r + 1} \frac{\varphi_{T_r + 1, i}^{3T_r + 1}}
          {\varphi_{T_r + 1, i}^{T_r + 1} + T_r} & \mbox{if } n=3T_r+1, \\
          % jiwjirjw
          \sum_{i=1}^{T_r + 1} \varphi_{T_r + 1, i}^n
          & \mbox{if } n > 3T_r + 1. \\
        \end{array}
      \right.,
    \end{equation}
    with $\ROC{\tilde{\ell}_{T_r}^{n}} = \{z \in \Complexes : |z| > \max_{i \in \Nk{T_r + 1}} |\varphi_{T_r + 1, i}|\}$.  
  
    Let $n = 2T_r$. There is 1 sequence in $\mathcal{Y}_{T_r}^{2T_r}$ with the form
    \begin{equation*}
      \overbrace{0 \cdots 0}
    \end{equation*} 
    and $2T_r$ sequences with the form
    \begin{equation*}
      \overbrace{0 \cdots 0}^{k_1 \geq 0} 1 \overbrace{0 \cdots 0}^{k_2 \geq 0},
    \end{equation*} 
    with $k_1 + k_2 = 2 T_r - 1 \geq T_r$, $k_1, k_2 \geq 0$.
    Thus, we necessarily have 
    \begin{equation}
      \sum_{i=1}^{T_r + 1} \frac{\varphi_{T_r + 1, i}^{3T_r + 1}}
          {\varphi_{T_r + 1, i}^{T_r + 1} + T_r} = T_r + 1, 
    \end{equation}
    and substituting $p = T_r + 1$, we prove \Cref{cor:A-8}.

    Now, we can use this result in the case $n = 3T_r + 1$ to get
    \begin{equation}
      \sum_{i=1}^{T_r + 1} \frac{\varphi_{T_r + 1, i}^{4T_r + 2}}
          {\varphi_{T_r + 1, i}^{T_r + 1} + T_r} + T_r \sum_{i=1}^{T_r + 1} \frac{\varphi_{T_r + 1, i}^{3T_r + 1}}
          {\varphi_{T_r + 1, i}^{T_r + 1} + T_r} = \sum_{i=1}^{T_r + 1} \frac{\varphi_{T_r + 1, i}^{T_r + 1 + 3T_r + 1}}
          {\varphi_{T_r + 1, i}^{T_r + 1} + T_r} + T_r (3T_r + 1) - 2T_r ^2,
    \end{equation}
    and merge it with $2T_r + 1 \leq n \leq 3T_r$.
  \end{proof}

  \begin{table}[!ht]
    \centering
    \begin{tabular}{*{12}{c}}
      \toprule
      & \multicolumn{10}{c}{$T_r$} \\
      $n$ & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ & $8$ & $9$ & $10$ \\
      \midrule
      1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 \\
      2 & 3 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 \\
      3 & 4 & 4 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 \\
      4 & 7 & 5 & 5 & 1 & 1 & 1 & 1 & 1 & 1 & 1 \\
      5 & 11 & 6 & 6 & 6 & 1 & 1 & 1 & 1 & 1 & 1 \\
      6 & 18 & 10 & 7 & 7 & 7 & 1 & 1 & 1 & 1 & 1 \\
      7 & 29 & 15 & 8 & 8 & 8 & 8 & 1 & 1 & 1 & 1 \\
      8 & 47 & 21 & 13 & 9 & 9 & 9 & 9 & 1 & 1 & 1 \\
      9 & 76 & 31 & 19 & 10 & 10 & 10 & 10 & 10 & 1 & 1 \\
      10 & 123 & 46 & 26 & 16 & 11 & 11 & 11 & 11 & 11 & 1 \\
      11 & 199 & 67 & 34 & 23 & 12 & 12 & 12 & 12 & 12 & 12 \\
      12 & 322 & 98 & 47 & 31 & 19 & 13 & 13 & 13 & 13 & 13 \\
      13 & 521 & 144 & 66 & 40 & 27 & 14 & 14 & 14 & 14 & 14 \\
      14 & 843 & 211 & 92 & 50 & 36 & 22 & 15 & 15 & 15 & 15 \\
      15 & 1364 & 309 & 126 & 66 & 46 & 31 & 16 & 16 & 16 & 16 \\
      16 & 2207 & 453 & 173 & 89 & 57 & 41 & 25 & 17 & 17 & 17 \\
      17 & 3571 & 664 & 239 & 120 & 69 & 52 & 35 & 18 & 18 & 18 \\
      18 & 5778 & 973 & 331 & 160 & 88 & 64 & 46 & 28 & 19 & 19 \\
      19 & 9349 & 1426 & 457 & 210 & 115 & 77 & 58 & 39 & 20 & 20 \\
      20 & 15127 & 2090 & 630 & 276 & 151 & 91 & 71 & 51 & 31 & 21 \\
      \bottomrule
    \end{tabular}
    \caption{$\ell_{T_r}^{n}$ with $1 \leq n \leq 20$ and $0 < T_r \leq 10$.}
    \label{tab:lnTr}
  \end{table}

  \begin{theorem} \label{thm:asymptotic}
    Let $\ell_{T_r}^{n}$ be as introduced before, with $n \in \Integers_{\geq 0}$ and fixed $T_r \in \Integers_{> 0}$.
    Then:
    \begin{equation}
      \lim_{n \to \infty} \ell_{T_r}^{n} = \hat{\varphi}_{T_r + 1}^n
    \end{equation}
    with $\hat{\varphi}_{T_r + 1}$ as defined in \Cref{thm:golden_number}.
  \end{theorem}

  \begin{proof}
    The proof follows directly from \Cref{thm:2-main} and \Cref{thm:golden_number}.
  \end{proof}

  It is interesting to notice that as $n$ goes large, the logarithmic of the number of valid sequences
  increases linearly in the length of the sequence as $\log \ell_{T_r}^{n} \simeq n \log \hat{\varphi}_{T_r + 1}$.
  The rate of increase corresponds to the number of bits per seconde required to specify the particular signal used.

  \begin{remark}
    As $T_r$ becomes large (i.e. $T_r \gg n$), we have:
    \begin{equation}
      \ell_{T_r}^{n} = 1,
    \end{equation}
    as the only valid sequence is the one without any spike.
  \end{remark}

  \begin{remark}
    For fixed $T_r > 0$ and for any $n \geq 0$, we have:
    \begin{equation}
      \ell_{T_r}^{n+1} > \ell_{T_r}^{n}.
    \end{equation}
  \end{remark}

  \begin{remark}
    For fixed $n \geq 0$ and for any $T_r > 0$, we have:
    \begin{equation}
      \ell_{T_r+1}^{n} < \ell_{T_r}^{n}.
    \end{equation}
  \end{remark}

  \begin{remark}[Capacity]
    The capacity $C$ of a channel transmitting signals in $\set{Y}_{T_r}^n$ is:
    \begin{equation}
      C \eqdef \lim_{n \to \infty} \frac{\log \ell_{T_r+1}^{n}}{n} = \log \hat{\varphi}_{T_r + 1}.
    \end{equation}
  \end{remark}

  Given a sample of $\mathcal{Y}_{T_r}^{n}$, it could also be interesting to know the probability 
  that it contains exactly $n_0$ zeros and $n_1$ ones. Let $\mathcal{Y}_{T_r}^{n_0, n_1}$ represent
  the set of sequences in $\mathcal{Y}_{T_r}^{n}$ with $n_0$ zeros and $n_1$ ones, $n_0 + n_1 = n$, $n_0, n_1 \geq 0$.
  It can be formally expressed as
  \begin{equation}
    \mathcal{Y}_{T_r}^{n_0, n_1} = \left\{(y_1, \dots, y_{n}) \in \mathcal{Y}_{T_r}^{n} : \sum_{i=1}^n y_i = n_1\right\},
  \end{equation}
  with $n = n_0 + n_1 > 0$.

  \begin{theorem}
    Let $\ell_{T_r}^{n_0,n_1}$ denotes the cardinality of $\mathcal{Y}_{T_r}^{n_0, n_1}$ with $n_0, n_1 \in \Integers_{\geq 0}$ and $T_r \in \Integers_{> 0}$. We have:
    \begin{equation}
      \ell_{T_r}^{n_0,n_1} = 
      \left\{
        \begin{array}{ll}
          0 & \mbox{if } n_0 < T_r n_1 \\
          1 & \mbox{if } n_1 = 0 \\
          n & \mbox{if } n_1 = 1 \\
          % \binom{n_0 + 2 - T_r}{2} - \frac{T_r(T_r+1)}{2} & \mbox{otherwise if } n_1 = 2 \\
          \binom{n - T_r n_1 + T_r}{n_1} - \sum_{k=2}^{T_r+1} \binom{n - T_r(n_1 - 1) - k}{n_1-2}(k-1) & \mbox{otherwise} \\
        \end{array}
      \right.,
    \end{equation}
  \end{theorem}


  \begin{proof}
    First of all, it is obvious that if $n_0 < T_r n_1$ we have $\ell_{T_r}^{n_0,n_1} = 0$. Let's now consider the non trivial cases with $n_0, n_1$ such that $n_0 \geq T_r n_1$
    If $n_1 = 0$, there is 1 sequence in $\mathcal{Y}_{T_r}^{n_0, n_1}$ with the form 
    \begin{equation*}
      \overbrace{0 \cdots 0}^n
    \end{equation*} 

    If $n_1 = 1$, there are $n$ sequence in $\mathcal{Y}_{T_r}^{n_0, n_1}$ with the form 
    \begin{equation*}
      \overbrace{0 \cdots 0}^{k_1} 1 \overbrace{0 \cdots 0}^{k_2},
    \end{equation*}
    with $k_1 + k_2 = n - 1 = n_0 \geq T_r$.
      
    If $n_1 \geq 2$, we have to consider sequences that are in $\tilde{\mathcal{Y}}_{T_r}^{n_0, n_1} \setminus \mathcal{Y}_{T_r}^{n_0, n_1}$ and then
    compute $\ell_{T_r}^{n_0,n_1}$ using 
    $\left|\mathcal{Y}_{T_r}^{n_0, n_1}\right| = \left|\tilde{\mathcal{Y}}_{T_r}^{n_0, n_1}\right| - \left|\tilde{\mathcal{Y}}_{T_r}^{n_0, n_1} \setminus \mathcal{Y}_{T_r}^{n_0, n_1}\right|$.
    If $n_1 = 2$, there are $\sum_{k=0}^{T_r-1} k+1$ sequences in $\tilde{\mathcal{Y}}_{T_r}^{n_0, n_1}\setminus\mathcal{Y}_{T_r}^{n_0, n_1}$ 
    with the form 
    \begin{equation*}
      \overbrace{0\cdots0}^{k_1} 1 \overbrace{0\cdots0}^{\geq T_r} 1 \overbrace{0\cdots0}^{k_2},
    \end{equation*}
    with $k_1, k_2 \geq 0$ and $0 \leq k_1 + k_2 \leq T_r - 1$.

    If $n_1 > 2$, any sequence in $\tilde{\mathcal{Y}}_{T_r}^{n_0, n_1}\setminus\mathcal{Y}_{T_r}^{n_0, n_1}$ has the form 
    \begin{equation}
      \overbrace{0\cdots0}^{k_1} 1 \overbrace{0\cdots0}^{T_r} \underbrace{y_{k_1 + T_r + 1} \cdots y_{n-k_2 - T_r}}_{\in \tilde{\mathcal{Y}}^{n_0 - 2T_r - k + 2, n_1 -2}_{T_r}} \overbrace{0\cdots0}^{T_r} 1 \overbrace{0\cdots0}^{k_2},
    \end{equation}
    with $k_1, k_2 \geq 0$ and $0 \leq k_1 + k_2 \leq T_r - 1$. Hence, there are 
    \begin{equation}
      \sum_{k=0}^{T_r-1} \tilde{\ell}_{T_r}^{n_0 - 2T_r - k + 2,n_1-2} (k+1) = \sum_{k=2}^{T_r+1} \binom{n - T_r(n_1 - 1) - k}{n_1-2}(k+1).
    \end{equation}
    such sequences.

    Now it suffices to notice that $\tilde{\ell}_{T_r}^{n_0 - 2T_r - k + 2, 0} = 1$ to merge case $n_1 = 2$ with case $n_1 > 2$ and complete 
    the proof.
  \end{proof}



  \clearpage


  \begin{table}[!ht]
    \centering
    \begin{tabular}{*{13}{c}}
      \toprule
      & \multicolumn{11}{c}{$n_1$} & \\
      $n$ & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & $\ell_{T_r}^{n}$ \\
      \midrule
      1 & 1 & 0 & - & - & - & - & - & - & - & - & - & 1 \\
      2 & 1 & 2 & 0 & - & - & - & - & - & - & - & - & 3 \\
      3 & 1 & 3 & 0 & 0 & - & - & - & - & - & - & - & 4 \\
      4 & 1 & 4 & 2 & 0 & 0 & - & - & - & - & - & - & 7 \\
      5 & 1 & 5 & 5 & 0 & 0 & 0 & - & - & - & - & - & 11 \\
      6 & 1 & 6 & 9 & 2 & 0 & 0 & 0 & - & - & - & - & 18 \\
      7 & 1 & 7 & 14 & 7 & 0 & 0 & 0 & 0 & - & - & - & 29 \\
      8 & 1 & 8 & 20 & 16 & 2 & 0 & 0 & 0 & 0 & - & - & 47 \\
      9 & 1 & 9 & 27 & 30 & 9 & 0 & 0 & 0 & 0 & 0 & - & 76 \\
      10 & 1 & 10 & 35 & 50 & 25 & 2 & 0 & 0 & 0 & 0 & 0 & 123 \\
      \bottomrule
    \end{tabular}
    \caption{$\ell_{T_r}^{n_0,n_1}$ for $0 < n \leq 10$, $0 \leq n_1 \leq n$ and $T_r = 1$.}
  \end{table}

  \begin{table}[!ht]
    \centering
    \begin{tabular}{*{13}{c}}
      \toprule
      & \multicolumn{11}{c}{$n_1$} & \\
      $n$ & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & $\ell_{T_r}^{n}$ \\
      \midrule
      1 & 1 & 0 & - & - & - & - & - & - & - & - & - & 1 \\
      2 & 1 & 0 & 0 & - & - & - & - & - & - & - & - & 1 \\
      3 & 1 & 3 & 0 & 0 & - & - & - & - & - & - & - & 4 \\
      4 & 1 & 4 & 0 & 0 & 0 & - & - & - & - & - & - & 5 \\
      5 & 1 & 5 & 0 & 0 & 0 & 0 & - & - & - & - & - & 6 \\
      6 & 1 & 6 & 3 & 0 & 0 & 0 & 0 & - & - & - & - & 10 \\
      7 & 1 & 7 & 7 & 0 & 0 & 0 & 0 & 0 & - & - & - & 15 \\
      8 & 1 & 8 & 12 & 0 & 0 & 0 & 0 & 0 & 0 & - & - & 21 \\
      9 & 1 & 9 & 18 & 3 & 0 & 0 & 0 & 0 & 0 & 0 & - & 31 \\
      10 & 1 & 10 & 25 & 10 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 46 \\
      \bottomrule
    \end{tabular}
    \caption{$\ell_{T_r}^{n_0,n_1}$ for $0 < n \leq 10$, $0 \leq n_1 \leq n$ and $T_r = 2$.}
  \end{table}


  \begin{table}[!ht]
    \centering
    \begin{tabular}{*{13}{c}}
      \toprule
      & \multicolumn{11}{c}{$n_1$} & \\
      $n$ & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & $\ell_{T_r}^{n}$ \\
      \midrule
      1 & 1 & 0 & - & - & - & - & - & - & - & - & - & 1 \\
      2 & 1 & 0 & 0 & - & - & - & - & - & - & - & - & 1 \\
      3 & 1 & 0 & 0 & 0 & - & - & - & - & - & - & - & 1 \\
      4 & 1 & 4 & 0 & 0 & 0 & - & - & - & - & - & - & 5 \\
      5 & 1 & 5 & 0 & 0 & 0 & 0 & - & - & - & - & - & 6 \\
      6 & 1 & 6 & 0 & 0 & 0 & 0 & 0 & - & - & - & - & 7 \\
      7 & 1 & 7 & 0 & 0 & 0 & 0 & 0 & 0 & - & - & - & 8 \\
      8 & 1 & 8 & 4 & 0 & 0 & 0 & 0 & 0 & 0 & - & - & 13 \\
      9 & 1 & 9 & 9 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & - & 19 \\
      10 & 1 & 10 & 15 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 26 \\
      \bottomrule
    \end{tabular}
    \caption{$\ell_{T_r}^{n_0,n_1}$ for $0 < n \leq 10$, $0 \leq n_1 \leq n$ and $T_r = 3$.}
  \end{table}

    %----------------------------------------------------------------------------------------
    \newpage
    \appendix
    \section{Generalized golden number}

    \begin{definition}[Generalized Golden Number of order $p$] \label{def:golden_number}
      Let $\varphi_{p, i} \in \Complexes$ be the $p$ complex roots of the polynomials $P(x) = x^p - x^{p-1} - 1$
      with $p \in \Integers_{\geq 2}$ and $i \in \Nk{p}$. The largest real root of $P(x)$ is called the \emph{Generalized Golden Number 
      of order $p$}.
    \end{definition}

    \begin{remark}
      Moreover, from the complex conjugate root Theorem, since $P$ is a polynomial in one variable with real coefficients, the roots are
      real or come in complex conjugate pairs.
    \end{remark}

    \begin{remark}
      From \Cref{def:golden_number}, it follows that for any $p_1, p_2 > 2$, the following holds:
      \begin{equation}
        \varphi_{p_1, i}^{p_1} - \varphi_{p_1, i}^{p_1-1} = \varphi_{p_1, i}^{p_1-1}(\varphi_{p_1, i} - 1) 
        = \varphi_{p_2, i}^{p_2-1}(\varphi_{p_2, i} - 1)  = \varphi_{p_2, i}^{p_2} - \varphi_{p_2, i}^{p_2-1},
      \end{equation}
    \end{remark}

    \begin{theorem} \label{thm:multiplicity}
      Any root of $P(x)$ has multiplicity one.
    \end{theorem}
    \begin{proof}
      Let $\varphi_{p, i}$ be a root of $P(x)$ and assume it has multiplicity $l > 1$. Then, $\varphi_{p, i}$ should also be a root of $P'(x)$, that is:
      \begin{equation}
        P'(\varphi_{p, i}) = p \varphi_{p, i}^{p-1} - (p - 1)\varphi_{p, i}^{p-2} = 0.
      \end{equation}
      Using the fact that $\varphi_{p, i} \neq 0$, for any $p > 1$ and $i \in \Nk{p}$, we get:
      \begin{equation}
        \varphi_{p, i} = \frac{p-1}{p},
      \end{equation}
      It yields:
      \begin{equation}
        P(\varphi_{p, i}) = \left(\frac{p-1}{p}\right)^p - \left(\frac{p-1}{p}\right)^{p-1} - 1 < 0,
      \end{equation}
      which is in contradiction with $P(\varphi_{p, i}) = 0$ and the proof is complete.
    \end{proof}

    \begin{theorem} \label{thm:sum_prod_roots}
      Let $\varphi_{p, i} \in \Complexes$ with $p \in \Integers_{\geq 2}$ and $i \in \Nk{p}$ be as in \Cref{def:golden_number}. Then, the following hold:
      \begin{align}
        \sum_{i=1}^p \varphi_{p, i} & = 1, \\
        \prod_{i=1}^p \varphi_{p, i} & = (-1)^{p-1}, \\
        \sum_{1 \leq i_1 < i_2 < \dots < i_{p - m} \leq p} \prod_{j=1}^{p - m} \varphi_{p, i_j} & = 0,
      \end{align}
      with $0 < m < p - 1$. 
    \end{theorem}

    \begin{proof}
      Using Vieta's formulas with $P(x) = x^n - x^{n-1} - 1$, we directly get the result. 
    \end{proof}

    \begin{corollary} \label{cor:A-3}
      Let $\varphi_{p, i} \in \Complexes$ with $p \in \Integers_{\geq 2}$ and $i \in \Nk{p}$ be as in \Cref{def:golden_number} and $0 < m < p$. 
      Then, the following hold:
      \begin{equation} 
        (-1)^{p-m} \varphi_{p, i}^{m} \sum_{\substack{1 \leq i_1 < i_2 < \dots < i_{p - m} \leq p \\ i_1, i_2, \dots, i_{p-1-m} \neq i}} 
        \prod_{j=1}^{p - m} \varphi_{p, i_j} = 1
      \end{equation}
    \end{corollary}

    \begin{proof}
      We prove it by induction. First of all, for $m = p-1$, we have:
      \begin{align} 
        \varphi_{p, i}^{p-1} \sum_{\substack{j = 1 \\ j \neq i}}^p \varphi_{p, i_j} 
        & = \varphi_{p, i}^{p-1}(1 - \varphi_{p, i}) \\
        & = \varphi_{p, i}^{p-1} - \varphi_{p, i}^{p} \\
        & = -1 \\
      \end{align}
      Assume, the property is true for $m+1 \leq p-1$ and prove it is also true for $m> 0$. We have:
      \begin{align} 
        \varphi_{p, i}^{m} \sum_{\substack{1 \leq i_1 < i_2 < \dots < i_{p - m} \leq p \\ i_1, i_2, \dots, i_{p-1-m} \neq i}} 
        \prod_{j=1}^{p - m} \varphi_{p, i_j} & = -\varphi_{p, i}^{m} \sum_{\substack{1 \leq i_1 < i_2 < \dots < i_{p - m} \leq p \\ i \in \{i_1, i_2, \dots, i_{p-m}\}}} 
        \prod_{j=1}^{p - m} \varphi_{p, i_j} \\ 
        & = -\varphi_{p, i}^{m+1} \sum_{\substack{1 \leq i_1 < i_2 < \dots < i_{p - m-1} \leq p \\ i_1, i_2, \dots, i_{p-m-1} \neq i}} 
        \prod_{j=1}^{p-m-1} \varphi_{p, i_j} \\
        & = -(-1)^{p-m-1} \\
        & = (-1)^{p-m},
      \end{align}
      and the proof is complete.
    \end{proof}

    \begin{corollary} \label{cor:A-4}
      Let $\varphi_{p, i} \in \Complexes$ with $p \in \Integers_{\geq 2}$ and $i \in \Nk{p}$ be as in \Cref{def:golden_number}. Then, the following hold:
      \begin{equation} 
        \sum_{i=1}^p \varphi_{p, i}^{p-1} = 1
      \end{equation}
    \end{corollary}

    \begin{proof}
      If $p=2$, we have $\sum_{i=1}^p \varphi_{p, i}^{p-1} = \sum_{i=1}^p \varphi_{p, i} = 1$. Now, assuming $p > 2$, we have:
      \begin{align} 
        \left(\sum_{i=1}^p \varphi_{p, i} \right)^{p-1} 
        & = (p-2)! \sum_{i=1}^p \varphi_{p, i}
        \sum_{\substack{1 \leq i_1 < \dots < i_{p - 2} \leq p \\ i_1, \dots, i_{p-2} \neq i}} \prod_{j=1}^{p - 2} \varphi_{p, i_j} \\ 
        \nonumber & + \sum_{m=2}^{p-2} \sum_{i=1}^p \frac{(p-1)!}{m!} \varphi_{p, i}^m 
        \sum_{\substack{1 \leq i_1 < \dots < i_{p - 1 - m} \leq p \\ i_1, \dots, i_{p-1-m} \neq i}} 
        \prod_{j=1}^{p - 1 - m} \varphi_{p, i_j} \\
        \nonumber & + \sum_{i=1}^p \varphi_{p, i}^{p-1} \\
        & = (p-2)!
        \sum_{i=1}^p \sum_{\substack{1 \leq i_1 < \dots < i_{p - 1} \leq p \\ i \in \{i_1, \dots, i_{p-1}\}}} \prod_{j=1}^{p - 1} \varphi_{p, i_j} \\
        \nonumber & + \sum_{m=2}^{p-2} \frac{(p-1)!}{m!} \sum_{i=1}^p \varphi_{p, i}^{m-1} 
        \sum_{\substack{1 \leq i_1 < \dots < i_{p - m} \leq p \\ i \in \{i_1, \dots, i_{p-m}\}}} 
        \prod_{j=1}^{p - m} \varphi_{p, i_j} \\
        \nonumber & + \sum_{i=1}^p \varphi_{p, i}^{p-1} \\
        & = (p-2)!
        \sum_{1 \leq i_1 < \dots < i_{p - 1}} \prod_{j=1}^{p - 1} \varphi_{p, i_j} \\
        \nonumber & + \sum_{m=2}^{p-2} \frac{(p-1)!}{m!} \varphi_{p, i}^{m-1} 
        \sum_{1 \leq i_1 < \dots < i_{p - m} \leq p} 
        \prod_{j=1}^{p - m} \varphi_{p, i_j} \\
        \nonumber & + \sum_{i=1}^p \varphi_{p, i}^{p-1} \\
        & = \sum_{i=1}^{p} \varphi_{p, i}^{p-1},
      \end{align}
      It suffices now to notice that $\sum_{i=1}^{p} \varphi_{p, i}^{p-1} = \left(\sum_{i=1}^p \varphi_{p, i} \right)^{p-1}$ to complete 
      the proof.
    \end{proof}

    \begin{corollary} \label{cor:A-5}
      Let $\varphi_{p, i} \in \Complexes$ with $p \in \Integers_{\geq 2}$ and $i \in \Nk{p}$ be as in \Cref{def:golden_number}. Then, the following hold:
      \begin{equation} 
        \varphi_{p, i} \prod_{\substack{j=1 \\ j \neq i}}^{p} (\varphi_{p, i} - \varphi_{p, j})
        =  \varphi_{p, i}^{p} + p -1 =  p + \varphi_{p, i}^{p-1}.
      \end{equation}
    \end{corollary}

    \begin{proof}
      We can directly develop the product to get the desire result:
      \begin{align}
        \varphi_{p, i} \prod_{\substack{j=1 \\ j \neq i}}^{p} (\varphi_{p, i} - \varphi_{p, j}) 
        &= \varphi_{p, i}^p + \sum_{m=1}^{p-1} (-1)^{p-m} \varphi_{p, i}^{m} 
        \sum_{\substack{1 \leq i_1 < \dots < i_{p-m} \leq p \\ i_1, \dots, i_{p-m} \neq i}} \prod_{j=1}^{p-m} \varphi_{p, i_j} \\
        &= \varphi_{p, i}^p + \sum_{m=1}^{p-1} 1 \\
        &= \varphi_{p, i}^p + p - 1 \\
        &= \varphi_{p, i}^{p-1} + p.
      \end{align}
    \end{proof}

    \begin{corollary} \label{cor:A-6}
      Let $\varphi_{p, i} \in \Complexes$ with $p \in \Integers_{\geq 2}$ and $i \in \Nk{p}$ be as in \Cref{def:golden_number}. Then, the following hold:
      \begin{equation} 
        \prod_{i=1}^{p} (1 - \varphi_{p, i}) = -1.
      \end{equation}
    \end{corollary}

    \begin{proof}
      We can directly develop the product to get the desire result:
      \begin{align}
        \prod_{i=1}^{p} (1 - \varphi_{p, i})
        & = \sum_{m=0}^{p} (-1)^{p-m} \sum_{1 \leq i_1 < \dots < i_{p-m} \leq p} \prod_{j=1}^{p-m} \varphi_{p, i_j}\\
        & = (-1)^{p} \prod_{i}^p \varphi_{p, i} \\
        \nonumber & + \sum_{m=1}^{p-2} (-1)^{m} \sum_{1 \leq i_1 < \dots < i_{p-m} \leq p} \prod_{j=1}^{p-m} \varphi_{p, i_j} \\
        \nonumber & - \sum_{i}^p \varphi_{p, i} \\
        \nonumber & + 1 \\
        & = (-1)^{p}\prod_{i}^p \varphi_{p, i} \\
        & = -1.
      \end{align}
    \end{proof}

    \begin{corollary} \label{cor:A-7}
      Let $\varphi_{p, i} \in \Complexes$ with $p \in \Integers_{\geq 2}$ and $i \in \Nk{p}$ be as in \Cref{def:golden_number}. Then, the following holds:
      \begin{equation} 
        \sum_{i=1}^{p} \frac{\varphi_{p, i}^{2p-1}}{\varphi_{p, i}^{p}+p-1} = 1.
      \end{equation}
    \end{corollary}

    \begin{proof}
      Proved in \Cref{thm:1-main}.
    \end{proof}

    \begin{corollary} \label{cor:A-8}
      Let $\varphi_{p, i} \in \Complexes$ with $p \in \Integers_{\geq 2}$ and $i \in \Nk{p}$ be as in \Cref{def:golden_number}. Then, the following holds:
      \begin{equation} 
        \sum_{i=1}^{p} \frac{\varphi_{p, i}^{3p-2}}{\varphi_{p, i}^{p}+p-1} = p.
      \end{equation}
    \end{corollary}

    \begin{proof}
      Proved in \Cref{thm:2-main}.
    \end{proof}

    % \begin{corollary} \label{cor:A-9}
    %   Let $\varphi_{p, i} \in \Complexes$ with $p \in \Integers_{\geq 2}$ and $i \in \Nk{p}$ be as in \Cref{def:golden_number}. Then, the following holds:
    %   \begin{equation} 
    %     \sum_{i=1}^{p} \frac{\varphi_{p, i}^{3p-1}}{\varphi_{p, i}^{p}+p-1} = p+1.
    %   \end{equation}
    % \end{corollary}

    % \begin{proof}
    %   Proved in \Cref{thm:2-main}.
    % \end{proof}

    % \begin{corollary} \label{cor:A-10}
    %   Let $\varphi_{p, i} \in \Complexes$ with $p \in \Integers_{\geq 2}$ and $i \in \Nk{p}$ be as in \Cref{def:golden_number}. Then, the following holds:
    %   \begin{equation} 
    %     \sum_{i=1}^{p} \frac{\varphi_{p, i}^{3p}}{\varphi_{p, i}^{p}+p-1} = 2(p+1).
    %   \end{equation}
    % \end{corollary}

    % \begin{proof}
    %   Proved in \Cref{thm:2-main}.
    % \end{proof}

    Of particular interest in our case is the distribution of $\varphi_{p, i}$ for $i \in \Nk{p}$ in the complex plan.

    \begin{theorem} \label{thm:one_two_rule}
      Let $\varphi_{p,1}$, $\varphi_{p,2}$ be as in \Cref{def:golden_number} with $p \in \Integers_{\geq 2}$ and such that
      $\varphi_{p,1} = r e^{i\theta_1}$ and $\varphi_{p,2} = r e^{i\theta_2}$ with $r \in \Reals_{>0}$ and $\theta_1 \neq \theta_2$. 
      Then we necessarily have $\theta_{1} = - \theta_{2}$.
    \end{theorem}

    \begin{proof}
      From \Cref{def:golden_number}, we have
      \begin{equation}
        r^p e^{i\theta_1p} - r^{p-1} e^{i\theta_1(p-1)}
        = r^p e^{i\theta_2p} - r^{p-1} e^{i\theta_2(p-1)}
      \end{equation}
      Now using the fact that $\theta_1 \neq \theta_2$, we have
      \begin{align}
        r = \frac{e^{i \theta_1 (p-1)} - e^{i \theta_2 (p-1)}}{e^{i \theta_1 p} - e^{i \theta_2 p}} = \frac{e^{i \frac{\theta_1 + \theta_2}{2}(p-1)} \left( e^{i \frac{\theta_1 - \theta_2}{2}(p-1)} - e^{-i \frac{\theta_1 - \theta_2}{2}(p-1)} \right)}
        {e^{i \frac{\theta_1 + \theta_2}{2}p} \left( e^{i \frac{\theta_1 - \theta_2}{2}p} - e^{-i \frac{\theta_1 - \theta_2}{2}p} \right)}
      \end{align}
      After some calculations, we can verify that $\carg{r} = 0$ (because $r \in \Reals_{>0}$) implies that $\theta_1 = -\theta_2$.
      
    \end{proof}

    \begin{remark}
      A direct consequence of this theorem is that there cannot exist more than two roots with the same modulus. If we are interested in 
      the set of roots with the largest modulus, then either this set contains only one real number, either it contains
      a pair of complex conjugate numbers.
    \end{remark}

    \begin{theorem}[Existence and uniqueness of the Golden Number of order $p$] \label{thm:golden_number}
      Let $\varphi_{p, i} \in \Complexes$ with $p \in \Integers_{\geq 2}$ and $i \in \Nk{p}$ be as in \Cref{def:golden_number}, and denote by 
      $\hat{\varphi}_p$ the root with the largest modulus. Then, the following hold:
      \begin{enumerate}
        \item $\hat{\varphi}_p$ exists;
        \item $\hat{\varphi}_p$ is unique;
        \item $\hat{\varphi}_p$ is a stricly positive real number.
      \end{enumerate}
    \end{theorem}

    \begin{proof}
      The fact that $\hat{\varphi}_p$ exists is obvious.

      From \Cref{thm:one_two_rule}, it follows that either $\hat{\varphi}_p$ is real, either it defines
      a pair of complex conjugate numbers. From \Cref{thm:2-main}, as $n$ goes large and with 
      $p = T_r + 1$, either $\ell^n_{p-1} \simeq \left(\hat{\varphi}_{p}\right)^{n} + \left(\cconj{\hat{\varphi}_p}\right)^n$ if $\hat{\varphi}_p$ 
      defines a pair of complex conjugate numbers either $\ell^n_{p-1} \simeq \left(\hat{\varphi}_{p}\right)^{n}$ if $\hat{\varphi}_p$ is real.
      
      But since $\ell^n_{p-1} > 0$ for any $n > 0$, we also should have $\left(\hat{\varphi}_{p}\right)^{n} + \left(\cconj{\hat{\varphi}_p}\right)^n = 2 \hat{r}^n \cos{n\hat{\theta}} > 0$ 
      which is not true for an arbitrary $n$ as $\hat{\theta} \mod{\pi} \neq 0$. In the same manner, we cannot have $\hat{\varphi}_{p} \in \Reals_{<0}$
      as $\left(\hat{\varphi}_{p}\right)^{n} = (-1)^n |\hat{\varphi}_{p}|^n$ in this case which can be negative. 
      Hence, necessarily, $\hat{\varphi}_{p} \in \Reals_{>0}$ and we have proven that $\hat{\varphi}_p$ is unique and a strictly positive real number.
    \end{proof}


    % \begin{proof}
    %   First of all, the existence of such a number is obvious. The second part of the statement can be proved defining 
    %   $\hat{\varphi}_{p}$ in terms of the asymptotic behavior of the number of cyclic firing signal. By definition, this number is necessarily 
    %   a strictly positive integer for any $n > 0$. Using \Cref{thm:2-main}, we have:
    %   \begin{equation}
    %     \lim_{n \to \infty} \ell_{p-1}^n = \sum_{i \in J} \varphi_{p, i}^n
    %   \end{equation} 
    %   where $J$ is the set of indices of corresponding to the roots with the largest modulus, i.e. 
    %   \begin{equation}
    %     J = \argmax_{\varphi_{p, i}} |\varphi_{p, i}|
    %   \end{equation}
      
    %   We can decompose $J$ as follows:
    %   \begin{itemize}
    %     \item either 0 or 1 strictly positive real root equals to $\hat{r}$,
    %     \item either 0 or 1 stricly negative real root equals to $- \hat{r}$,
    %     \item $m$ pairs of complex conjugate root equal to $\hat{r} e^{i\hat{\theta}_l}$, all with the same modulus but 
    %     possibly with different argument $\hat{\theta}_l \mod{\pi} \neq 0$, $l\in \Nk{m}$.
    %   \end{itemize}
      
    %   Let's consider the different cases. If there exists some complex roots we have :
    %   \begin{equation}
    %     \lim_{n \to \infty} \ell_{p-1}^n = 2 \hat{r}^n \sum_{l = 1}^{m} \cos{n\hat{\theta}_l},
    %   \end{equation}
    %   if no root are real,
    %   \begin{equation}
    %     \lim_{n \to \infty} \ell_{p-1}^n = \hat{r}^n \left(1 + 2 \sum_{l = 1}^{m} \cos{n\hat{\theta}_l}\right),
    %   \end{equation}
    %   if there also exists a strictly positive real root,
    %   \begin{equation}
    %     \lim_{n \to \infty} \ell_{p-1}^n = \hat{r}^n \left((-1)^n + 2 \sum_{l = 1}^{m} \cos{n\hat{\theta}_l}\right),
    %   \end{equation}
    %   if there also exists a strictly negative real root, and
    %   \begin{equation}
    %     \lim_{n \to \infty} \ell_{p-1}^n = \hat{r}^n \left(\frac{1 + (-1)^n}{2} + 2 \sum_{l = 1}^{m} \cos{n\hat{\theta}_l}\right),
    %   \end{equation}
    %   if there also exist one strictly positive root root and one strictly negative real root.
      
    %   In any cases, these numbers are non integer for some values of $n$ and thus all roots with largest modulus
    %   are necessarily real. With a similar argument, we can also prove that the root with largest modulus
    %   is necessarily a strictly positive real number, otherwise the limit could be less or equal to 0 for some values
    %   of $n$.
    % \end{proof}

    \begin{table}
      \centering
      \begin{tabular}{*{8}{c}}
        \toprule
        $p$ & $\hat{\varphi}_p$ & $p$ & $\hat{\varphi}_p$ & $p$ & $\hat{\varphi}_p$ & $p$ & $\hat{\varphi}_p$ \\
        \midrule
        1 & 2 & 51 & 1.058439 & 101 & 1.034301 & 151 & 1.024919 \\
        2 & 1.618034 & 52 & 1.057571 & 102 & 1.034035 & 152 & 1.024788 \\
        3 & 1.465571 & 53 & 1.056732 & 103 & 1.033774 & 153 & 1.024659 \\
        4 & 1.380278 & 54 & 1.05592 & 104 & 1.033517 & 154 & 1.02453 \\
        5 & 1.324718 & 55 & 1.055133 & 105 & 1.033265 & 155 & 1.024404 \\
        6 & 1.285199 & 56 & 1.054371 & 106 & 1.033017 & 156 & 1.024278 \\
        7 & 1.255423 & 57 & 1.053632 & 107 & 1.032772 & 157 & 1.024154 \\
        8 & 1.232055 & 58 & 1.052915 & 108 & 1.032532 & 158 & 1.024032 \\
        9 & 1.21315 & 59 & 1.052219 & 109 & 1.032296 & 159 & 1.023911 \\
        10 & 1.197491 & 60 & 1.051544 & 110 & 1.032063 & 160 & 1.023791 \\
        11 & 1.184276 & 61 & 1.050888 & 111 & 1.031834 & 161 & 1.023672 \\
        12 & 1.172951 & 62 & 1.05025 & 112 & 1.031609 & 162 & 1.023555 \\
        13 & 1.16312 & 63 & 1.04963 & 113 & 1.031387 & 163 & 1.023439 \\
        14 & 1.154494 & 64 & 1.049027 & 114 & 1.031169 & 164 & 1.023325 \\
        15 & 1.146854 & 65 & 1.04844 & 115 & 1.030954 & 165 & 1.023211 \\
        16 & 1.140034 & 66 & 1.047869 & 116 & 1.030742 & 166 & 1.023099 \\
        17 & 1.133902 & 67 & 1.047312 & 117 & 1.030534 & 167 & 1.022988 \\
        18 & 1.128356 & 68 & 1.04677 & 118 & 1.030328 & 168 & 1.022878 \\
        19 & 1.123311 & 69 & 1.046241 & 119 & 1.030126 & 169 & 1.022769 \\
        20 & 1.118699 & 70 & 1.045726 & 120 & 1.029927 & 170 & 1.022662 \\
        21 & 1.114465 & 71 & 1.045223 & 121 & 1.02973 & 171 & 1.022555 \\
        22 & 1.110562 & 72 & 1.044733 & 122 & 1.029536 & 172 & 1.02245 \\
        23 & 1.10695 & 73 & 1.044254 & 123 & 1.029345 & 173 & 1.022346 \\
        24 & 1.103598 & 74 & 1.043787 & 124 & 1.029157 & 174 & 1.022242 \\
        25 & 1.100476 & 75 & 1.04333 & 125 & 1.028972 & 175 & 1.02214 \\
        26 & 1.097561 & 76 & 1.042884 & 126 & 1.028789 & 176 & 1.022039 \\
        27 & 1.094833 & 77 & 1.042448 & 127 & 1.028608 & 177 & 1.021939 \\
        28 & 1.092272 & 78 & 1.042022 & 128 & 1.02843 & 178 & 1.02184 \\
        29 & 1.089863 & 79 & 1.041605 & 129 & 1.028255 & 179 & 1.021742 \\
        30 & 1.087593 & 80 & 1.041198 & 130 & 1.028082 & 180 & 1.021644 \\
        31 & 1.08545 & 81 & 1.040799 & 131 & 1.027911 & 181 & 1.021548 \\
        32 & 1.083422 & 82 & 1.040409 & 132 & 1.027743 & 182 & 1.021453 \\
        33 & 1.0815 & 83 & 1.040027 & 133 & 1.027576 & 183 & 1.021358 \\
        34 & 1.079675 & 84 & 1.039653 & 134 & 1.027412 & 184 & 1.021265 \\
        35 & 1.077941 & 85 & 1.039286 & 135 & 1.02725 & 185 & 1.021172 \\
        36 & 1.07629 & 86 & 1.038927 & 136 & 1.027091 & 186 & 1.021081 \\
        37 & 1.074717 & 87 & 1.038576 & 137 & 1.026933 & 187 & 1.02099 \\
        38 & 1.073215 & 88 & 1.038231 & 138 & 1.026777 & 188 & 1.0209 \\
        39 & 1.071779 & 89 & 1.037893 & 139 & 1.026623 & 189 & 1.020811 \\
        40 & 1.070406 & 90 & 1.037562 & 140 & 1.026472 & 190 & 1.020723 \\
        41 & 1.069091 & 91 & 1.037237 & 141 & 1.026322 & 191 & 1.020635 \\
        42 & 1.06783 & 92 & 1.036918 & 142 & 1.026174 & 192 & 1.020548 \\
        43 & 1.066619 & 93 & 1.036606 & 143 & 1.026027 & 193 & 1.020463 \\
        44 & 1.065457 & 94 & 1.036299 & 144 & 1.025883 & 194 & 1.020378 \\
        45 & 1.064339 & 95 & 1.035998 & 145 & 1.02574 & 195 & 1.020293 \\
        46 & 1.063264 & 96 & 1.035702 & 146 & 1.025599 & 196 & 1.02021 \\
        47 & 1.062228 & 97 & 1.035412 & 147 & 1.02546 & 197 & 1.020127 \\
        48 & 1.06123 & 98 & 1.035127 & 148 & 1.025323 & 198 & 1.020045 \\
        49 & 1.060267 & 99 & 1.034846 & 149 & 1.025187 & 199 & 1.019964 \\
        50 & 1.059337 & 100 & 1.034571 & 150 & 1.025052 & 200 & 1.019883 \\
        \bottomrule
      \end{tabular}
      \caption{Golden number $\hat{\varphi}_p$ for various $p$.}
    \end{table}

    \begin{table}
      \centering
      \begin{tabular}{cc}
        \toprule
        $p$ & Duration \\
        \midrule
        10 & $\SI{41.1}{\micro\second} \pm \SI{724}{\nano\second}$\\
        100 & $\SI{1.02}{\milli\second} \pm \SI{10.9}{\micro\second}$\\
        1000 & $\SI{1.5}{\second} \pm \SI{46.3}{\milli\second}$\\
        \bottomrule
      \end{tabular}
      \caption{Computation time to find the $p$ roots of $P(x) = x^p - x^{p-1} - 1$.}
    \end{table}


    \begin{remark}
      It follows from \Cref{thm:golden_number} that for any $p > 1$, $|\hat{\varphi}_p| = \hat{\varphi}_p$
    \end{remark}

    \begin{theorem} \label{thm:A-10}
      Let $\hat{\varphi}_{p} \in \Reals_{>0}$ with $p \in \Integers_{\geq 2}$ be as in \Cref{thm:golden_number}. Then, the following holds:
      \begin{equation} 
        \hat{\varphi}_p > 1.
      \end{equation}
    \end{theorem}

    \begin{proof}
      Using \Cref{thm:sum_prod_roots}, we have:
      \begin{equation} 
        \hat{\varphi}_p^p = |\hat{\varphi}_p|^p = \left(\max_{i \in \Nk{p}} |\varphi_{p, i}|\right)^p \geq \prod_{i=1}^p |\varphi_{p, i}| 
        = \left|\prod_{i=1}^p \varphi_{p, i}\right| = 1,
      \end{equation}
      and thus:
      \begin{equation} 
        \hat{\varphi}_p \geq 1^{1/p} = 1,
      \end{equation}
      Noticing that for any $p > 1$, $\hat{\varphi}_p \neq 1$ as $1^p - 1^{p-1} -1 = -1 \neq 0$, we complete the proof.
    \end{proof}

    \begin{theorem} \label{thm:A-11}
      Let $\hat{\varphi}_{p} \in \Reals_{>0}$ with $p \in \Integers_{\geq 2}$ be as in \Cref{thm:golden_number}. Then, the following holds:
      \begin{equation} 
        \hat{\varphi}_p > \hat{\varphi}_{p+1}.
      \end{equation}
    \end{theorem}
    
    \begin{proof}
      As previously mentionned, we have:
      \begin{align}
        \hat{\varphi}_{p+1}^{p}(\hat{\varphi}_{p+1} - 1) = \hat{\varphi}_{p}^{p-1}(\hat{\varphi}_{p} - 1) 
      \end{align}
      Now assume $\hat{\varphi}_{p+1} = \hat{\varphi}_{p} + \varepsilon$, with $\varepsilon \geq 0$ and let's show it yields to 
      a contradiction. We have:
      \begin{align} 
        \hat{\varphi}_{p+1}^{p}(\hat{\varphi}_{p+1} - 1) 
        & = (\hat{\varphi}_{p} + \varepsilon)^{p}(\hat{\varphi}_{p} + \varepsilon - 1) \\
        & \geq \hat{\varphi}_{p}^{p}(\hat{\varphi}_{p} + \varepsilon - 1) \\
        & > \hat{\varphi}_{p}^{p-1}(\hat{\varphi}_{p} + \varepsilon - 1) \\
        & \geq \hat{\varphi}_{p}^{p-1}(\hat{\varphi}_{p} - 1)
      \end{align}
      where we used \Cref{thm:A-10} in the third step. This is a contradiction with $\hat{\varphi}_{p+1}^{p}(\hat{\varphi}_{p+1} - 1) 
      = \hat{\varphi}_{p}^{p-1}(\hat{\varphi}_{p} - 1)$. Hence we necessarily have $\hat{\varphi}_{p+1} = \hat{\varphi}_{p} + \varepsilon$,
      with $\varepsilon < 0$, or in other terms, $\hat{\varphi}_{p+1} < \hat{\varphi}_{p}$.
    \end{proof}

    \begin{remark}
     It follows that for any $p > 2$, $\hat{\varphi}_p < \hat{\varphi}_2 = \frac{1 + \sqrt{5}}{2}$.
    \end{remark}

    \section{Z-Transforms}

    \begin{theorem} \label{thm:1-mainz}
      Let $\tilde{\ell}_{T_r}^{n}$ be as introduced in \Cref{thm:1-recursion}, with $T_r > 0$ and $n \geq 0$. 
      Its Z-Transform satisfies:
      \begin{equation}
        \frac{\tilde{\mathcal{L}}_{T_r}(z)}{z} = \frac{\tilde{A}}{z} + \sum_{i=1}^{T_r + 1} \frac{\tilde{B}_i}{z - \varphi_{T_r + 1, i}}.
      \end{equation}
      with 
      \begin{equation}
        \tilde{A} = -1,
      \end{equation}
      \begin{equation}
        \tilde{B}_i = \frac{\varphi_{T_r + 1, i}^{2T_r + 1}}{\varphi_{T_r + 1, i}^{T_r + 1} + T_r},
      \end{equation}
      and $\varphi_{T_r + 1, i}$ with $i \in \Nk{T_r + 1}$ as defined above.
    \end{theorem}

    \begin{proof}
      By directly computing the Z-Transform of \Cref{thm:1-recursion}, we get
      \begin{align}
        \tilde{\mathcal{L}}_{T_r}(z) & \eqdef \sum_{n \geq 0} \tilde{\ell}_{T_r}^{n} z^{-n} \\
        & = 2 z^{-1} + \sum_{n = 2}^{T_r+1} z^{-n} + \sum_{n \geq 2} \tilde{\ell}_{T_r}^{n-1} z^{-n} 
        + \sum_{n \geq T_r + 2} \tilde{\ell}_{T_r}^{n-1-T_r} z^{-n} \\
        & = z^{-1} + \sum_{n = 1}^{T_r+1} z^{-n} + z^{-1}\sum_{n \geq 1} \tilde{\ell}_{T_r}^{n} z^{-n} 
        + z^{-1-T_r} \sum_{n \geq 1} \tilde{\ell}_{T_r}^{n} z^{-n} \\
        & = z^{-1} + z^{-T_r-1}\frac{1-z^{T_r + 1}}{1 - z} + z^{-1} \tilde{\mathcal{L}}_{T_r}(z) 
        + z^{-1-T_r} \tilde{\mathcal{L}}_{T_r}(z),
      \end{align}

      and then 
      \begin{equation}
        \frac{\tilde{\mathcal{L}}_{T_r}(z)}{z} = \frac{z^{T_r} + \frac{1-z^{T_r + 1}}{1 - z}}{z \prod_{i=1}^{T_r + 1} (z - \varphi_{T_r + 1, i})},
      \end{equation}
      where $\varphi_{T_r + 1, i}$ for $i \in \Nk{T_r + 1}$ as in \Cref{def:golden_number}. Since every poles have multiplicity one and the degree of the denominator is larger than the degree of the numerator, we can make partial fraction decomposition to get:
      \begin{equation}
        \frac{\tilde{\mathcal{L}}_{T_r}(z)}{z} =  \frac{\tilde{A}}{z} + \sum_{i=1}^{T_r + 1} \frac{\tilde{B}_i}{z - \varphi_{T_r + 1, i}},
      \end{equation}
      Using \Cref{thm:sum_prod_roots}, we obtain
      \begin{equation}
        \tilde{A} = \eval{z\frac{\tilde{\mathcal{L}}_{T_r}(z)}{z}}{z = 0} = \frac{(-1)^{T_r + 1}}{\prod_{i=1}^{T_r + 1} \varphi_{T_r + 1, i}} = -1.
      \end{equation}
      Using \Cref{def:golden_number} and \Cref{cor:A-5}, we get
      \begin{align}
        \tilde{B}_i & = \eval{(z - \varphi_{T_r + 1, i})\frac{\tilde{\mathcal{L}}_{T_r}(z)}{z}}{z = \varphi_{T_r + 1, i}}  \\  
        & =  \frac{\varphi_{T_r + 1, i}^{T_r} + \frac{1 - \varphi_{T_r + 1, i}^{T_r + 1}}{1 - \varphi_{T_r + 1, i}}}
        {\varphi_{T_r + 1, i} \prod_{\substack{j=1 \\ j \neq i}}^{T_r + 1} (\varphi_{T_r + 1, i} - \varphi_{T_r + 1, j})} \\
        % & =  \frac{\varphi_{T_r + 1, i}^{T_r} + \frac{1 - \varphi_{T_r + 1, i}^{T_r + 1}}{1 - \varphi_{T_r + 1, i}}}
        % {\varphi_{T_r + 1, i}^{T_r + 1} + T_r} \\
        & =  \frac{\varphi_{T_r + 1, i}^{T_r} - \frac{\varphi_{T_r + 1, i}^{T_r}}{1-\varphi_{T_r + 1, i}}}
        {\varphi_{T_r + 1, i}^{T_r + 1} + T_r} \\
        & =  \frac{\varphi_{T_r + 1, i}^{T_r} - \varphi_{T_r + 1, i}^{T_r+1} - \varphi_{T_r + 1, i}^{T_r}}
        {(\varphi_{T_r + 1, i}^{T_r + 1} + T_r)(1-\varphi_{T_r + 1, i})} \\
        & =  \frac{\varphi_{T_r + 1, i}^{T_r+1}}
        {(\varphi_{T_r + 1, i}^{T_r + 1} + T_r)\varphi_{T_r + 1, i}^{-T_r}} \\
        & =  \frac{\varphi_{T_r + 1, i}^{2T_r + 1}}
        {\varphi_{T_r + 1, i}^{T_r + 1} + T_r},
      \end{align} 
      for $i \in \Nk{T_r + 1}$.
    \end{proof}


    % \begin{theorem} 
    %   Let $T_r > 0$ and $\varphi_{T_r + 1, i} \in \Complexes$ with $i \in \Nk{T_r + 1}$ be as defined in \Cref{def:golden_number}. The inverse Z-Transform $\bar{\ell}_{T_r}^n$ of $\frac{\tilde{\mathcal{L}}_{T_r}(z)}{z-1}$ is given by:
    %   \begin{align}
    %     \bar{\ell}_{T_r}^n = 
    %     \left\{
    %       \begin{array}{ll}
    %         \sum_{i=1}^{T_r + 1} \frac{\varphi_{T_r + 1, i}^{3T_r + 1 + n}}
    %     {\varphi_{T_r + 1, i}^{T_r + 1} + T_r} - (T_r+2) & \mbox{if } n > 0 \\
    %         0 & \mbox{otherwise}
    %       \end{array}
    %     \right.,
    %   \end{align}
    %   with $\ROC{\bar{\ell}_{T_r}^n} = \{z \in \Complexes: |z| > \max_{i \in \Nk{T_r + 1}} |\varphi_{T_r + 1, i}|\}$.
    % \end{theorem}

    % \begin{proof}
    %   Because of \Cref{thm:1-mainz}, the Z-transform can be expressed as:
    %   \begin{align}
    %     \frac{\tilde{\mathcal{L}}_{T_r}(z)}{z(z-1)} =  \frac{A}{z} + \sum_{i=1}^{T_r + 1} \frac{B_i}{z - \varphi_{T_r + 1, i}} + \frac{C}{z-1},
    %   \end{align}
    %   with 
    %   \begin{equation}
    %     A = \eval{z\frac{\tilde{\mathcal{L}}_{T_r}(z)}{z(z-1)}}{z = 0} = - \tilde{A} = 1,
    %   \end{equation}
    %   \begin{equation}
    %     B_i = \eval{(z - \varphi_{T_r + 1, i})\frac{\tilde{\mathcal{L}}_{T_r}(z)}{z(z-1)}}{z = \varphi_{T_r + 1, i}} = \frac{\tilde{B}_i}{\varphi_{T_r + 1, i}-1} = \frac{\varphi_{T_r + 1, i}^{3T_r + 1}}
    %     {\varphi_{T_r + 1, i}^{T_r + 1} + T_r},
    %   \end{equation}
    %   and
    %   \begin{align}
    %     C & = \eval{(z - 1)\frac{\tilde{\mathcal{L}}_{T_r}(z)}{z(z-1)}}{z = 1}  \\  
    %     & =  \eval{\frac{z^{T_r} + \sum_{k=0}^{T_r} z^{k}}{z \prod_{j=1}^{T_r + 1} 
    %     (z - \varphi_{T_r + 1, j})}}{z = 1} \\
    %     & =  \frac{1 + \sum_{k=0}^{T_r} 1}{\prod_{i=1}^{T_r + 1} (1 - \varphi_{T_r + 1, i})} \\
    %     & = -(T_r + 2),
    %   \end{align}
    %   where we used \Cref{cor:A-6} in the last step.

    %   By inverting the Z-Transform and using \Cref{cor:A-8} and \Cref{thm:A-10}, we obtain:
    %   \begin{equation}
    %     \bar{\ell}_{T_r}^{n} = 
    %     \left\{
    %       \begin{array}{ll}
    %         \sum_{i=1}^{T_r + 1} \frac{\varphi_{T_r + 1, i}^{3T_r + 1 + n}}
    %         {\varphi_{T_r + 1, i}^{T_r + 1} + T_r} - (T_r+2) & \mbox{if } n > 0 \\
    %         0 & \mbox{otherwise}
    %       \end{array}
    %     \right.,
    %   \end{equation}
    %   with $\ROC{\bar{\ell}_{T_r}^n} = \{z \in \Complexes: |z| > \max_{i \in \Nk{T_r + 1}} |\varphi_{T_r + 1, i}|\}$.
    % \end{proof}

    \begin{theorem} \label{thm:2-mainz}
      Let $\ell_{T_r}^{n}$ be as introduced in \Cref{thm:2-recursion}, with $T_r > 0$ and $n \geq 0$. 
      Its Z-Transform satisfies:
      \begin{align}
        \mathcal{L}_{T_r}(z) 
        & = \frac{z}{z-1} (z^{-1} + T_r z^{-T_r-1}) \\
        \nonumber & + \frac{z}{(z-1)^2} (z^{-T_r} - z^{-2T_r-1} + T_r z^{-2T_r-2} - T_r z^{-3T_r-2})  \\
        \nonumber & + \frac{\tilde{\mathcal{L}}_{T_r}(z)}{z-1}(z^{-2T_r} + T_r z^{-3T_r-1}).
      \end{align}
      Moreover, we have:
      \begin{equation}
        \bar{\ell}_{T_r}^{n} \eqdef  \InvZTrans{\frac{\tilde{\mathcal{L}}_{T_r}(z)}{z-1}}[n] = 
        \left\{
          \begin{array}{ll}
            \sum_{i=1}^{T_r + 1} \frac{\varphi_{T_r + 1, i}^{3T_r + 1 + n}}
            {\varphi_{T_r + 1, i}^{T_r + 1} + T_r} - (T_r+2) & \mbox{if } n > 0 \\
            0 & \mbox{otherwise}
          \end{array}
        \right.,
      \end{equation}
      with $\ROC{\bar{\ell}_{T_r}^n} = \{z \in \Complexes: |z| > \max_{i \in \Nk{T_r + 1}} |\varphi_{T_r + 1, i}|\}$.
    \end{theorem}

    \begin{proof}
      By directly computing the Z-Transform of \Cref{thm:2-recursion}, we get
      \begin{align}
        \mathcal{L}_{T_r}(z) & \eqdef \sum_{n \geq 0} \ell_{T_r}^{n} z^{-n} \\
        & = \sum_{n \geq 1} \ell_{T_r}^{n-1} z^{-n} + \sum_{n \geq 2T_r + 2} \tilde{\ell}_{T_r}^{n-2T_r-1} z^{-n} + T_r \sum_{n \geq 3T_r + 3} \tilde{\ell}_{T_r}^{n-3T_r-2} z^{-n} \\
        \nonumber & + T_r z^{-T_r - 1} + z^{-1} + \sum_{n =T_r+1}^{2T_r + 1} z^{-n} + T_r \sum_{n =2T_r+2}^{3T_r + 2} z^{-n} \\
        & = z^{-1} \sum_{n \geq 1} \ell_{T_r}^{n} z^{-n} + \left(z^{-2T_r-1} + T_r z^{-3T_r-2}\right) \sum_{n \geq 1} \tilde{\ell}_{T_r}^{n} z^{-n} \\
        \nonumber & + \sum_{n =T_r+1}^{2T_r + 1} z^{-n} + T_r z^{-T_r - 1} + z^{-1} + T_r \sum_{n =2T_r+2}^{3T_r + 2} z^{-n} \\
        & = z^{-1} \mathcal{L}_{T_r}(z) + \left(z^{-2T_r-1} + T_r z^{-3T_r-2}\right) \tilde{\mathcal{L}}_{T_r}(z) \\
        \nonumber & +  T_r z^{-T_r - 1} + z^{-1} + \frac{z^{-T_r} - z^{-2T_r-1}}{z-1} + T_r \frac{z^{-2T_r-1} - z^{-3T_r-2}}{z-1} \\
        % & = z^{-1} \mathcal{L}_{T_r}(z) + \left(z^{-2T_r} + T_r z^{-3T_r-1}\right)
        % \left(\frac{\tilde{A}}{z} + \sum_{i=1}^{T_r + 1} \frac{\tilde{B}_i}{z - \varphi_{T_r + 1, i}}\right) \\
        % \nonumber & +  T_r z^{-T_r - 1} + z^{-1} + \frac{z^{-T_r} - z^{-2T_r-1}}{z-1} + T_r \frac{z^{-2T_r-1} - z^{-3T_r-2}}{z-1} \\
      \end{align}
      and thus:
      \begin{align}
        \mathcal{L}_{T_r}(z)
        & = \frac{z}{z-1} (z^{-1} + T_r z^{-T_r-1}) \\
        \nonumber & + \frac{z}{(z-1)^2} (z^{-T_r} - z^{-2T_r-1} + T_r z^{-2T_r-1} - T_r z^{-3T_r-2})  \\
        \nonumber & + \frac{\tilde{\mathcal{L}}_{T_r}(z)}{z-1}(z^{-2T_r} + T_r z^{-3T_r-1}).
      \end{align}

      Let's now compute the following inverse Z-Transform
      \begin{equation}
        \bar{\ell}_{T_r}^{n} \eqdef \InvZTrans{\frac{\tilde{\mathcal{L}}_{T_r}(z)}{z-1}}[n].
      \end{equation}
      
      Using \Cref{thm:1-mainz}, we have:
      \begin{align}
        \frac{\tilde{\mathcal{L}}_{T_r}(z)}{z(z-1)} =  \frac{A}{z} + \sum_{i=1}^{T_r + 1} \frac{B_i}{z - \varphi_{T_r + 1, i}} + \frac{C}{z-1},
      \end{align}
      with 
      \begin{equation}
        A = \eval{z\frac{\tilde{\mathcal{L}}_{T_r}(z)}{z(z-1)}}{z = 0} = - \tilde{A} = 1,
      \end{equation}
      \begin{equation}
        B_i = \eval{(z - \varphi_{T_r + 1, i})\frac{\tilde{\mathcal{L}}_{T_r}(z)}{z(z-1)}}{z = \varphi_{T_r + 1, i}} = \frac{\tilde{B}_i}{\varphi_{T_r + 1, i}-1} = \frac{\varphi_{T_r + 1, i}^{3T_r + 1}}
        {\varphi_{T_r + 1, i}^{T_r + 1} + T_r},
      \end{equation}
      and
      \begin{align}
        C = \eval{(z - 1)\frac{\tilde{\mathcal{L}}_{T_r}(z)}{z(z-1)}}{z = 1} = -(T_r + 2),
      \end{align}
      using \Cref{cor:A-6}.

      Using \Cref{thm:A-10}, we obtain:
      \begin{equation}
        \bar{\ell}_{T_r}^{n} = 
        \left\{
          \begin{array}{ll}
            \sum_{i=1}^{T_r + 1} \frac{\varphi_{T_r + 1, i}^{3T_r + 1 + n}}
            {\varphi_{T_r + 1, i}^{T_r + 1} + T_r} - T_r - 2 & \mbox{if } n > 0 \\
            \sum_{i=1}^{T_r + 1} \frac{\varphi_{T_r + 1, i}^{3T_r + 1 + n}}
            {\varphi_{T_r + 1, i}^{T_r + 1} + T_r} -T_r -1& \mbox{if } n = 0 \\
            0 & \mbox{otherwise}
          \end{array}
        \right.,
      \end{equation}
      with $\ROC{\bar{\ell}_{T_r}^n} = \{z \in \Complexes: |z| > \max_{i \in \Nk{T_r + 1}} |\varphi_{T_r + 1, i}|\}$.

    \end{proof}

\end{document}

